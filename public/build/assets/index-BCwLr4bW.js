const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/echo-C3DaSZ5c.js","assets/app-CMeUrf50.js","assets/app-DkbKbqH8.css"])))=>i.map(i=>d[i]);
import{r as x,j as e,H as _,L as a,a as c,_ as k}from"./app-CMeUrf50.js";import{B as l}from"./x-CZYrHTRQ.js";import{C as p,a as S,b as T,c as h}from"./card-Cwxw5GdZ.js";import{B as f}from"./badge-CpbHZjhE.js";import{A as C}from"./app-layout-nNCjU6Ur.js";import{S as E,a as L,b as I,c as P,d as i}from"./select-BU5oTjNs.js";import{P as V}from"./plus-BJ4kQvgy.js";import{M as A}from"./message-square-Bem12P6R.js";/* empty css            */import"./app-sidebar-header-CztvwVfL.js";import"./appearance-dropdown-CIplfUHR.js";import"./index-CASGKN-W.js";import"./index-Cfp_L9w6.js";import"./log-out-C9Jhd31W.js";import"./index-wVJuMR_H.js";import"./proxy-B-sAeQ2V.js";import"./circle-check-Bv3Kk_K_.js";import"./loader-circle-PC8s1h8o.js";import"./circle-x-qFpOssZO.js";import"./circle-alert-tomiUAeh.js";import"./dollar-sign-3i0DvXHD.js";import"./file-text-DBGV6D9F.js";import"./users-BjCKGoHP.js";import"./user-check-B_uMkO9r.js";import"./clock-C3FzQv_v.js";import"./shield-CzJFJRG5.js";import"./index-BQCSxHRW.js";import"./check-DXgzueCv.js";import"./chevron-up-B8DO_JqK.js";const g=".tickets.list.updated",B=[{title:"Support Tickets",href:"/tickets"}],D={open:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",in_progress:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",closed:"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300"},H={low:"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300",medium:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",high:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300"};function pe({tickets:r,filters:j,auth:d}){const n=x.useRef(null);x.useEffect(()=>{let t=null;const o=1e3,u=d?.user?.id;if(u==null)return;const m=`user.${u}.tickets`,y=()=>{if(!(typeof window>"u"||!window.Echo))try{const s=n.current;s&&typeof s.stopListening=="function"&&s.stopListening(g),window.Echo.leaveChannel(m),n.current=null}catch(s){console.error("WebSocket: Error leaving tickets channel",s)}};return(async()=>{try{const s=(await k(async()=>{const{default:w}=await import("./echo-C3DaSZ5c.js");return{default:w}},__vite__mapDeps([0,1,2]))).default(),v=()=>{t&&clearTimeout(t),t=setTimeout(()=>{t=null,c.reload({only:["tickets"]})},o)},N=s.private(m).listen(g,v);n.current=N}catch(s){console.error("Failed to initialize WebSocket:",s)}})(),()=>{t&&clearTimeout(t),y()}},[d?.user?.id]);const b=t=>{c.get("/tickets",{status:t||null})};return e.jsxs(C,{breadcrumbs:B,children:[e.jsx(_,{title:"Support Tickets"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Support Tickets"}),e.jsx(a,{href:"/tickets/create",children:e.jsxs(l,{children:[e.jsx(V,{className:"mr-2 h-4 w-4"}),"New Ticket"]})})]}),e.jsx("div",{className:"flex gap-4",children:e.jsxs(E,{value:j?.status||"all",onValueChange:b,children:[e.jsx(L,{className:"w-[180px]",children:e.jsx(I,{placeholder:"Filter by status"})}),e.jsxs(P,{children:[e.jsx(i,{value:"all",children:"All Statuses"}),e.jsx(i,{value:"open",children:"Open"}),e.jsx(i,{value:"in_progress",children:"In Progress"}),e.jsx(i,{value:"closed",children:"Closed"})]})]})}),r?.data&&r.data.length>0?e.jsx("div",{className:"grid gap-4",children:r.data.map(t=>e.jsxs(p,{className:"hover:shadow-md transition-shadow",children:[e.jsx(S,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(T,{className:"mb-2",children:e.jsx(a,{href:`/tickets/${t.id}`,className:"hover:underline",children:t.subject})}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx(f,{className:D[t.status],children:t.status.replace("_"," ")}),e.jsx(f,{className:H[t.priority],children:t.priority})]})]}),e.jsx(a,{href:`/tickets/${t.id}`,children:e.jsxs(l,{variant:"outline",size:"sm",children:[e.jsx(A,{className:"mr-2 h-4 w-4"}),"View"]})})]})}),e.jsxs(h,{children:[e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:t.description}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Created ",new Date(t.created_at).toLocaleDateString()]})]})]},t.id))}):e.jsx(p,{children:e.jsxs(h,{className:"py-10 text-center",children:[e.jsx("p",{className:"text-muted-foreground",children:"No tickets found."}),e.jsx(a,{href:"/tickets/create",className:"mt-4 inline-block",children:e.jsx(l,{children:"Create your first ticket"})})]})}),r?.links&&e.jsx("div",{className:"flex justify-center gap-2",children:r.links.map((t,o)=>e.jsx(l,{variant:t.active?"default":"outline",size:"sm",onClick:()=>t.url&&c.get(t.url),disabled:!t.url,dangerouslySetInnerHTML:{__html:t.label}},o))})]})]})}export{pe as default};
