import{c as as,r as q,u as ls,j as s,a as ye,H as rs,L as ns}from"./app-zh9bNfQA.js";import{B as o}from"./createLucideIcon-BZjvJ1Zn.js";import{C as ze,c as Ze}from"./card-BdZbHl6r.js";import{I as is}from"./input-DiGHHSH4.js";import{L as n}from"./label-Bimm6ppi.js";import{T as cs}from"./textarea-vl710I3f.js";import{A as os}from"./admin-layout-BWrldFRv.js";import{B as ds,D as ms,a as xs,b as hs,c as $e,d as be,e as ps}from"./appearance-dropdown-Bb28oTQN.js";import{D as Ve,a as us,b as qe,c as Ge,d as Je,e as Ke}from"./dialog-BDMD06yW.js";import{C as Fe}from"./circle-check-big-DpF25LQg.js";import{T as Re}from"./triangle-alert-B_NYeNJG.js";import{B as Ie}from"./ban-DmjGbP-p.js";import{U as fs}from"./users-DRMz8fhj.js";import{D as js}from"./dollar-sign-DV-oRcFJ.js";import{C as gs}from"./calendar-B3bfc_Ei.js";import{E as Ns}from"./ellipsis-Chtya659.js";import{E as bs}from"./eye-D9WOzGrZ.js";import{C as ys}from"./chevron-left-PCMpYS35.js";import{S as vs,A as Qe}from"./search-Cvxybfoh.js";/* empty css            */import"./index-BJwOBxES.js";import"./app-sidebar-header-CRr_1DPO.js";import"./index-Bvd5418W.js";import"./index-NEtNT4ix.js";import"./x-BIBjS2Dr.js";import"./index-CcLcdVZM.js";import"./log-out-D2fYovF8.js";import"./chevron-right-O9ILxyvV.js";import"./chevron-down-C7_CWyHS.js";import"./index-CaEI0-fE.js";import"./shield-DgxHpXTb.js";import"./message-square-CrR61UD7.js";import"./file-text-DIkPgk9X.js";import"./lock-BsRQ3mjQ.js";import"./credit-card-DZtV9Y3R.js";import"./chart-column-S0VcatN5.js";import"./index-BH508O9j.js";const ws=[{title:"Admin",href:"/admin"},{title:"Businesses",href:"/admin/businesses"}];function ht(l){const e=as.c(121),{businesses:r,statusCounts:ve,filters:d}=l,[c,We]=q.useState(d.search),[m,Xe]=q.useState(d.status),[a,we]=q.useState(null),[Se,J]=q.useState(!1),[i,Ye]=q.useState("active"),[Ce,_e]=q.useState(!1);let K;e[0]===Symbol.for("react.memo_cache_sentinel")?(K={status:"active",reason:""},e[0]=K):K=e[0];const{data:De,setData:x,post:Be,processing:h,reset:Ae}=ls(K),es=As,ke=Bs;let Q;e[1]!==c||e[2]!==m?(Q=t=>{t.preventDefault(),ye.get("/admin/businesses",{search:c,status:m},{preserveState:!0})},e[1]=c,e[2]=m,e[3]=Q):Q=e[3];const Te=Q;let W;e[4]!==c?(W=t=>{Xe(t),ye.get("/admin/businesses",{search:c,status:t},{preserveState:!0})},e[4]=c,e[5]=W):W=e[5];const Ee=W;let X;e[6]!==d?(X=t=>{const Ne=d.sort===t&&d.direction==="asc"?"desc":"asc";ye.get("/admin/businesses",{...d,sort:t,direction:Ne},{preserveState:!0})},e[6]=d,e[7]=X):X=e[7];const p=X;let Y;e[8]!==x?(Y=(t,Ne)=>{we(t),Ye(Ne),x({status:Ne,reason:""}),J(!0)},e[8]=x,e[9]=Y):Y=e[9];const G=Y;let ee;e[10]!==Be||e[11]!==Ae||e[12]!==a?(ee=()=>{a&&Be(`/admin/businesses/${a.id}/status`,{onSuccess:()=>{J(!1),we(null),Ae()}})},e[10]=Be,e[11]=Ae,e[12]=a,e[13]=ee):ee=e[13];const Le=ee;let se;e[14]===Symbol.for("react.memo_cache_sentinel")?(se=t=>{we(t),_e(!0)},e[14]=se):se=e[14];const ss=se,He=Ds,Pe=_s,ts=Cs;let te;e[15]===Symbol.for("react.memo_cache_sentinel")?(te=s.jsx(rs,{title:"Admin - Manage Businesses"}),e[15]=te):te=e[15];let ae;e[16]===Symbol.for("react.memo_cache_sentinel")?(ae=s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold",children:"Manage Businesses"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"View and manage all businesses on the platform"})]}),e[16]=ae):ae=e[16];let le;e[17]===Symbol.for("react.memo_cache_sentinel")?(le=s.jsxs("div",{className:"flex items-center justify-between",children:[ae,s.jsx(ns,{href:"/admin",children:s.jsxs(o,{variant:"outline",children:[s.jsx(ys,{className:"mr-2 h-4 w-4"}),"Back to Dashboard"]})})]}),e[17]=le):le=e[17];let u;e[18]!==Ee||e[19]!==ve||e[20]!==m?(u=s.jsx("div",{className:"flex gap-2 border-b pb-2",children:["all","active","suspended","banned"].map(t=>s.jsxs(o,{variant:m===t?"default":"ghost",size:"sm",onClick:()=>Ee(t),className:"gap-2",children:[t==="all"&&s.jsx(ds,{className:"h-4 w-4"}),t==="active"&&s.jsx(Fe,{className:"h-4 w-4"}),t==="suspended"&&s.jsx(Re,{className:"h-4 w-4"}),t==="banned"&&s.jsx(Ie,{className:"h-4 w-4"}),t.charAt(0).toUpperCase()+t.slice(1),s.jsx("span",{className:"ml-1 rounded-full bg-muted px-2 py-0.5 text-xs",children:ve[t]})]},t))}),e[18]=Ee,e[19]=ve,e[20]=m,e[21]=u):u=e[21];let re;e[22]===Symbol.for("react.memo_cache_sentinel")?(re=s.jsx(vs,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e[22]=re):re=e[22];let ne;e[23]===Symbol.for("react.memo_cache_sentinel")?(ne=t=>We(t.target.value),e[23]=ne):ne=e[23];let f;e[24]!==c?(f=s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"relative",children:[re,s.jsx(is,{placeholder:"Search by name, email, or registration number...",value:c,onChange:ne,className:"pl-10"})]})}),e[24]=c,e[25]=f):f=e[25];let ie;e[26]===Symbol.for("react.memo_cache_sentinel")?(ie=s.jsx(o,{type:"submit",children:"Search"}),e[26]=ie):ie=e[26];let j;e[27]!==Te||e[28]!==f?(j=s.jsx(ze,{children:s.jsx(Ze,{className:"pt-6",children:s.jsxs("form",{onSubmit:Te,className:"flex gap-4",children:[f,ie]})})}),e[27]=Te,e[28]=f,e[29]=j):j=e[29];let g;e[30]!==p?(g=()=>p("name"),e[30]=p,e[31]=g):g=e[31];let ce;e[32]===Symbol.for("react.memo_cache_sentinel")?(ce=s.jsx(Qe,{className:"h-3 w-3"}),e[32]=ce):ce=e[32];let N;e[33]!==g?(N=s.jsx("th",{className:"pb-3 pr-4",children:s.jsxs("button",{onClick:g,className:"flex items-center gap-1 hover:text-foreground",children:["Business",ce]})}),e[33]=g,e[34]=N):N=e[34];let oe,de;e[35]===Symbol.for("react.memo_cache_sentinel")?(oe=s.jsx("th",{className:"pb-3 pr-4",children:"Owner"}),de=s.jsx("th",{className:"pb-3 pr-4",children:"Status"}),e[35]=oe,e[36]=de):(oe=e[35],de=e[36]);let b;e[37]!==p?(b=()=>p("created_at"),e[37]=p,e[38]=b):b=e[38];let me;e[39]===Symbol.for("react.memo_cache_sentinel")?(me=s.jsx(Qe,{className:"h-3 w-3"}),e[39]=me):me=e[39];let y;e[40]!==b?(y=s.jsx("th",{className:"pb-3 pr-4",children:s.jsxs("button",{onClick:b,className:"flex items-center gap-1 hover:text-foreground",children:["Created",me]})}),e[40]=b,e[41]=y):y=e[41];let xe,he;e[42]===Symbol.for("react.memo_cache_sentinel")?(xe=s.jsx("th",{className:"pb-3 pr-4",children:"Stats"}),he=s.jsx("th",{className:"pb-3",children:"Actions"}),e[42]=xe,e[43]=he):(xe=e[42],he=e[43]);let v;e[44]!==N||e[45]!==y?(v=s.jsx("thead",{children:s.jsxs("tr",{className:"border-b text-left text-sm text-muted-foreground",children:[N,oe,de,y,xe,he]})}),e[44]=N,e[45]=y,e[46]=v):v=e[46];let w;e[47]!==r.data||e[48]!==G?(w=r.data.length>0?r.data.map(t=>s.jsxs("tr",{className:"border-b last:border-0",children:[s.jsx("td",{className:"py-4 pr-4",children:s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:t.name}),s.jsx("p",{className:"text-xs text-muted-foreground",children:t.email||"No email"}),t.registration_number&&s.jsxs("p",{className:"text-xs text-muted-foreground",children:["Reg: ",t.registration_number]})]})}),s.jsx("td",{className:"py-4 pr-4",children:s.jsxs("div",{children:[s.jsx("p",{className:"text-sm",children:t.owner?.name||"Unknown"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:t.owner?.email||""})]})}),s.jsxs("td",{className:"py-4 pr-4",children:[He(t.status),t.status_reason&&s.jsx("p",{className:"text-xs text-muted-foreground mt-1 max-w-[150px] truncate",title:t.status_reason,children:t.status_reason})]}),s.jsx("td",{className:"py-4 pr-4",children:s.jsx("p",{className:"text-sm",children:ke(t.created_at)})}),s.jsx("td",{className:"py-4 pr-4",children:s.jsxs("div",{className:"flex gap-3 text-xs text-muted-foreground",children:[s.jsxs("span",{className:"flex items-center gap-1",title:"Employees",children:[s.jsx(fs,{className:"h-3 w-3"}),t.employees_count]}),s.jsxs("span",{className:"flex items-center gap-1",title:"Payment Schedules",children:[s.jsx(js,{className:"h-3 w-3"}),t.payment_schedules_count]}),s.jsxs("span",{className:"flex items-center gap-1",title:"Payroll Schedules",children:[s.jsx(gs,{className:"h-3 w-3"}),t.payroll_schedules_count]})]})}),s.jsx("td",{className:"py-4",children:s.jsxs(ms,{children:[s.jsx(xs,{asChild:!0,children:s.jsx(o,{variant:"ghost",size:"sm",children:s.jsx(Ns,{className:"h-4 w-4"})})}),s.jsxs(hs,{align:"end",children:[s.jsx($e,{children:"Actions"}),s.jsxs(be,{onClick:()=>ss(t),children:[s.jsx(bs,{className:"mr-2 h-4 w-4"}),"View Details"]}),s.jsx(ps,{}),s.jsx($e,{children:"Change Status"}),t.status!=="active"&&s.jsxs(be,{onClick:()=>G(t,"active"),children:[s.jsx(Fe,{className:"mr-2 h-4 w-4 text-green-600"}),"Activate"]}),t.status!=="suspended"&&s.jsxs(be,{onClick:()=>G(t,"suspended"),children:[s.jsx(Re,{className:"mr-2 h-4 w-4 text-yellow-600"}),"Suspend"]}),t.status!=="banned"&&s.jsxs(be,{onClick:()=>G(t,"banned"),children:[s.jsx(Ie,{className:"mr-2 h-4 w-4 text-red-600"}),"Ban"]})]})]})})]},t.id)):s.jsx("tr",{children:s.jsx("td",{colSpan:6,className:"py-8 text-center text-muted-foreground",children:"No businesses found"})}),e[47]=r.data,e[48]=G,e[49]=w):w=e[49];let S;e[50]!==w?(S=s.jsx("tbody",{children:w}),e[50]=w,e[51]=S):S=e[51];let C;e[52]!==v||e[53]!==S?(C=s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[v,S]})}),e[52]=v,e[53]=S,e[54]=C):C=e[54];let _;e[55]!==r.data.length||e[56]!==r.last_page||e[57]!==r.links||e[58]!==r.total?(_=r.last_page>1&&s.jsxs("div",{className:"flex items-center justify-between mt-4 pt-4 border-t",children:[s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",r.data.length," of ",r.total," businesses"]}),s.jsx("div",{className:"flex gap-1",children:r.links.map(Ss)})]}),e[55]=r.data.length,e[56]=r.last_page,e[57]=r.links,e[58]=r.total,e[59]=_):_=e[59];let D;e[60]!==C||e[61]!==_?(D=s.jsx(ze,{children:s.jsxs(Ze,{className:"pt-6",children:[C,_]})}),e[60]=C,e[61]=_,e[62]=D):D=e[62];let B;e[63]!==i?(B=Pe(i),e[63]=i,e[64]=B):B=e[64];let A;e[65]!==B?(A=s.jsxs(Ve,{children:[B," Business"]}),e[65]=B,e[66]=A):A=e[66];let k;e[67]!==i?(k=ts(i),e[67]=i,e[68]=k):k=e[68];let T;e[69]!==k?(T=s.jsx(us,{children:k}),e[69]=k,e[70]=T):T=e[70];let E;e[71]!==A||e[72]!==T?(E=s.jsxs(qe,{children:[A,T]}),e[71]=A,e[72]=T,e[73]=E):E=e[73];const Me=a?.name;let L;e[74]!==Me?(L=s.jsxs("p",{className:"text-sm font-medium",children:["Business: ",Me]}),e[74]=Me,e[75]=L):L=e[75];const Oe=a?.status;let M;e[76]!==Oe?(M=s.jsxs("p",{className:"text-xs text-muted-foreground",children:["Current status: ",Oe]}),e[76]=Oe,e[77]=M):M=e[77];let O;e[78]!==L||e[79]!==M?(O=s.jsxs("div",{children:[L,M]}),e[78]=L,e[79]=M,e[80]=O):O=e[80];let pe;e[81]===Symbol.for("react.memo_cache_sentinel")?(pe=s.jsx(n,{htmlFor:"reason",children:"Reason (optional)"}),e[81]=pe):pe=e[81];let U;e[82]!==x?(U=t=>x("reason",t.target.value),e[82]=x,e[83]=U):U=e[83];let F;e[84]!==De.reason||e[85]!==U?(F=s.jsxs("div",{className:"space-y-2",children:[pe,s.jsx(cs,{id:"reason",placeholder:"Provide a reason for this status change...",value:De.reason,onChange:U,rows:3})]}),e[84]=De.reason,e[85]=U,e[86]=F):F=e[86];let R;e[87]!==O||e[88]!==F?(R=s.jsxs("div",{className:"space-y-4 py-4",children:[O,F]}),e[87]=O,e[88]=F,e[89]=R):R=e[89];let ue;e[90]===Symbol.for("react.memo_cache_sentinel")?(ue=s.jsx(o,{variant:"outline",onClick:()=>J(!1),children:"Cancel"}),e[90]=ue):ue=e[90];const Ue=i==="banned"?"destructive":i==="suspended"?"secondary":"default";let I;e[91]!==i||e[92]!==h?(I=h?"Updating...":Pe(i),e[91]=i,e[92]=h,e[93]=I):I=e[93];let H;e[94]!==Le||e[95]!==h||e[96]!==Ue||e[97]!==I?(H=s.jsxs(Ge,{children:[ue,s.jsx(o,{onClick:Le,disabled:h,variant:Ue,children:I})]}),e[94]=Le,e[95]=h,e[96]=Ue,e[97]=I,e[98]=H):H=e[98];let P;e[99]!==E||e[100]!==R||e[101]!==H?(P=s.jsxs(Je,{children:[E,R,H]}),e[99]=E,e[100]=R,e[101]=H,e[102]=P):P=e[102];let z;e[103]!==Se||e[104]!==P?(z=s.jsx(Ke,{open:Se,onOpenChange:J,children:P}),e[103]=Se,e[104]=P,e[105]=z):z=e[105];let fe;e[106]===Symbol.for("react.memo_cache_sentinel")?(fe=s.jsx(qe,{children:s.jsx(Ve,{children:"Business Details"})}),e[106]=fe):fe=e[106];let Z;e[107]!==a?(Z=a&&s.jsxs("div",{className:"space-y-4 py-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(n,{className:"text-xs text-muted-foreground",children:"Business Name"}),s.jsx("p",{className:"font-medium",children:a.name})]}),s.jsxs("div",{children:[s.jsx(n,{className:"text-xs text-muted-foreground",children:"Status"}),s.jsx("div",{children:He(a.status)})]}),s.jsxs("div",{children:[s.jsx(n,{className:"text-xs text-muted-foreground",children:"Email"}),s.jsx("p",{children:a.email||"N/A"})]}),s.jsxs("div",{children:[s.jsx(n,{className:"text-xs text-muted-foreground",children:"Phone"}),s.jsx("p",{children:a.phone||"N/A"})]}),s.jsxs("div",{children:[s.jsx(n,{className:"text-xs text-muted-foreground",children:"Business Type"}),s.jsx("p",{children:a.business_type||"N/A"})]}),s.jsxs("div",{children:[s.jsx(n,{className:"text-xs text-muted-foreground",children:"Registration Number"}),s.jsx("p",{children:a.registration_number||"N/A"})]}),s.jsxs("div",{children:[s.jsx(n,{className:"text-xs text-muted-foreground",children:"Owner"}),s.jsx("p",{children:a.owner?.name||"Unknown"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:a.owner?.email})]}),s.jsxs("div",{children:[s.jsx(n,{className:"text-xs text-muted-foreground",children:"Created"}),s.jsx("p",{children:ke(a.created_at)})]}),s.jsxs("div",{children:[s.jsx(n,{className:"text-xs text-muted-foreground",children:"Escrow Balance"}),s.jsx("p",{className:"font-medium text-primary",children:es(a.escrow_balance)})]}),s.jsxs("div",{children:[s.jsx(n,{className:"text-xs text-muted-foreground",children:"Statistics"}),s.jsxs("div",{className:"flex gap-4 text-sm",children:[s.jsxs("span",{children:[a.employees_count," employees"]}),s.jsxs("span",{children:[a.payment_schedules_count," payments"]}),s.jsxs("span",{children:[a.payroll_schedules_count," payroll"]})]})]})]}),a.status_reason&&s.jsxs("div",{children:[s.jsx(n,{className:"text-xs text-muted-foreground",children:"Status Reason"}),s.jsx("p",{className:"text-sm",children:a.status_reason})]}),a.status_changed_at&&s.jsxs("div",{children:[s.jsx(n,{className:"text-xs text-muted-foreground",children:"Status Changed"}),s.jsx("p",{className:"text-sm",children:ke(a.status_changed_at)})]})]}),e[107]=a,e[108]=Z):Z=e[108];let je;e[109]===Symbol.for("react.memo_cache_sentinel")?(je=s.jsx(Ge,{children:s.jsx(o,{variant:"outline",onClick:()=>_e(!1),children:"Close"})}),e[109]=je):je=e[109];let $;e[110]!==Z?($=s.jsxs(Je,{className:"max-w-2xl",children:[fe,Z,je]}),e[110]=Z,e[111]=$):$=e[111];let V;e[112]!==Ce||e[113]!==$?(V=s.jsx(Ke,{open:Ce,onOpenChange:_e,children:$}),e[112]=Ce,e[113]=$,e[114]=V):V=e[114];let ge;return e[115]!==u||e[116]!==j||e[117]!==D||e[118]!==z||e[119]!==V?(ge=s.jsxs(os,{breadcrumbs:ws,children:[te,s.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4",children:[le,u,j,D,z,V]})]}),e[115]=u,e[116]=j,e[117]=D,e[118]=z,e[119]=V,e[120]=ge):ge=e[120],ge}function Ss(l,e){return s.jsx(o,{variant:l.active?"default":"outline",size:"sm",disabled:!l.url,onClick:()=>l.url&&ye.get(l.url),dangerouslySetInnerHTML:{__html:l.label}},e)}function Cs(l){return{active:"This will reactivate the business and allow them to perform all operations.",suspended:"This will temporarily suspend the business. They will not be able to perform any operations until reactivated.",banned:"This will permanently ban the business. This action should be used for serious violations."}[l]}function _s(l){return{active:"Activate",suspended:"Suspend",banned:"Ban"}[l]}function Ds(l){const e={active:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",suspended:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",banned:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"},r={active:s.jsx(Fe,{className:"h-3 w-3"}),suspended:s.jsx(Re,{className:"h-3 w-3"}),banned:s.jsx(Ie,{className:"h-3 w-3"})};return s.jsxs("span",{className:`inline-flex items-center gap-1 rounded-full px-2 py-1 text-xs font-medium ${e[l]||""}`,children:[r[l],l.charAt(0).toUpperCase()+l.slice(1)]})}function Bs(l){return l?new Date(l).toLocaleDateString("en-ZA",{year:"numeric",month:"short",day:"numeric"}):"N/A"}function As(l){return new Intl.NumberFormat("en-ZA",{style:"currency",currency:"ZAR"}).format(Number(l))}export{ht as default};
