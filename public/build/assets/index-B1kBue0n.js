import{c as _e,r as k,j as t,a as te,H as Ne,L as ve}from"./app-BRoNAUIM.js";import{B as se,C as ye}from"./x-pZV5lkp5.js";import{C as de,c as oe}from"./card-Bag7gWUQ.js";import{I as ce}from"./input-6bP_JhyV.js";import{L as ee}from"./label-BAqrWHKw.js";import{a as Se,b as Ce,d as me,c as we,S as Ae}from"./select-Cv0uEHLH.js";import{A as ke}from"./admin-layout-BnJz0fFz.js";import{C as Fe,d as Le,e as De}from"./app-sidebar-header-BbzcXdQi.js";import{C as Te}from"./clock-DWicTrer.js";import{F as Be}from"./file-text-FWLsz4T5.js";import{U as Ee}from"./user-CZCf8guy.js";import{B as Ue}from"./appearance-dropdown-BEtN_wNg.js";import{G as Ie}from"./globe-fF7TX2ux.js";import{C as He}from"./chevron-up-DDm2opro.js";import{C as Me}from"./chevron-left-uzkLnT6H.js";import{S as Oe,A as Ve}from"./search-R_nGZEO9.js";/* empty css            */import"./index-CBJSSLbQ.js";import"./index-CfMSX17F.js";import"./index-BohsM0ZD.js";import"./check-CU7v0mdS.js";import"./shield-Kl3V0fgW.js";import"./users-CEYKQlp0.js";import"./message-square-CEp_sz_O.js";import"./lock-Dth4hMuh.js";import"./chart-column-DlXi8TWy.js";import"./index-Cfp_L9w6.js";import"./log-out-MC42nTzo.js";const ze=[{title:"Admin",href:"/admin"},{title:"Audit Logs",href:"/admin/audit-logs"}];function Nt(a){const e=_e.c(81),{logs:l,actionTypes:ae,filters:r}=a,[n,xe]=k.useState(r.search),[o,he]=k.useState(r.action),[i,fe]=k.useState(r.date_from),[c,ue]=k.useState(r.date_to);let F;e[0]===Symbol.for("react.memo_cache_sentinel")?(F=new Set,e[0]=F):F=e[0];const[d,pe]=k.useState(F),ge=Je;let L;e[1]!==o||e[2]!==i||e[3]!==c||e[4]!==n?(L=s=>{s.preventDefault(),te.get("/admin/audit-logs",{search:n,action:o,date_from:i,date_to:c},{preserveState:!0})},e[1]=o,e[2]=i,e[3]=c,e[4]=n,e[5]=L):L=e[5];const le=L;let D;e[6]!==i||e[7]!==c||e[8]!==n?(D=s=>{he(s),te.get("/admin/audit-logs",{search:n,action:s,date_from:i,date_to:c},{preserveState:!0})},e[6]=i,e[7]=c,e[8]=n,e[9]=D):D=e[9];const re=D;let T;e[10]!==r?(T=s=>{const A=r.sort===s&&r.direction==="asc"?"desc":"asc";te.get("/admin/audit-logs",{...r,sort:s,direction:A},{preserveState:!0})},e[10]=r,e[11]=T):T=e[11];const ne=T;let B;e[12]!==d?(B=s=>{const A=new Set(d);A.has(s)?A.delete(s):A.add(s),pe(A)},e[12]=d,e[13]=B):B=e[13];const ie=B,je=$e,be=Re;let E;e[14]===Symbol.for("react.memo_cache_sentinel")?(E=t.jsx(Ne,{title:"Admin - Audit Logs"}),e[14]=E):E=e[14];let U;e[15]===Symbol.for("react.memo_cache_sentinel")?(U=t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold",children:"Audit Logs"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"View all system activity and changes"})]}),e[15]=U):U=e[15];let I;e[16]===Symbol.for("react.memo_cache_sentinel")?(I=t.jsxs("div",{className:"flex items-center justify-between",children:[U,t.jsx(ve,{href:"/admin",children:t.jsxs(se,{variant:"outline",children:[t.jsx(Me,{className:"mr-2 h-4 w-4"}),"Back to Dashboard"]})})]}),e[16]=I):I=e[16];let H;e[17]===Symbol.for("react.memo_cache_sentinel")?(H=t.jsx(ee,{htmlFor:"search",className:"sr-only",children:"Search"}),e[17]=H):H=e[17];let M;e[18]===Symbol.for("react.memo_cache_sentinel")?(M=t.jsx(Oe,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e[18]=M):M=e[18];let O;e[19]===Symbol.for("react.memo_cache_sentinel")?(O=s=>xe(s.target.value),e[19]=O):O=e[19];let m;e[20]!==n?(m=t.jsxs("div",{className:"md:col-span-2",children:[H,t.jsxs("div",{className:"relative",children:[M,t.jsx(ce,{id:"search",placeholder:"Search actions, models, or IP addresses...",value:n,onChange:O,className:"pl-10"})]})]}),e[20]=n,e[21]=m):m=e[21];let V;e[22]===Symbol.for("react.memo_cache_sentinel")?(V=t.jsx(ee,{htmlFor:"action",className:"sr-only",children:"Action Type"}),e[22]=V):V=e[22];let z;e[23]===Symbol.for("react.memo_cache_sentinel")?(z=t.jsx(Se,{children:t.jsx(Ce,{placeholder:"All Actions"})}),e[23]=z):z=e[23];let G;e[24]===Symbol.for("react.memo_cache_sentinel")?(G=t.jsx(me,{value:"all",children:"All Actions"}),e[24]=G):G=e[24];let x;e[25]!==ae?(x=ae.map(Pe),e[25]=ae,e[26]=x):x=e[26];let h;e[27]!==x?(h=t.jsxs(we,{children:[G,x]}),e[27]=x,e[28]=h):h=e[28];let f;e[29]!==o||e[30]!==re||e[31]!==h?(f=t.jsxs("div",{children:[V,t.jsxs(Ae,{value:o,onValueChange:re,children:[z,h]})]}),e[29]=o,e[30]=re,e[31]=h,e[32]=f):f=e[32];let P;e[33]===Symbol.for("react.memo_cache_sentinel")?(P=t.jsx(se,{type:"submit",children:"Apply Filters"}),e[33]=P):P=e[33];let u;e[34]!==m||e[35]!==f?(u=t.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[m,f,P]}),e[34]=m,e[35]=f,e[36]=u):u=e[36];let R;e[37]===Symbol.for("react.memo_cache_sentinel")?(R=t.jsx(ee,{htmlFor:"date_from",children:"From Date"}),e[37]=R):R=e[37];let $;e[38]===Symbol.for("react.memo_cache_sentinel")?($=s=>fe(s.target.value),e[38]=$):$=e[38];let p;e[39]!==i?(p=t.jsxs("div",{children:[R,t.jsx(ce,{id:"date_from",type:"date",value:i,onChange:$})]}),e[39]=i,e[40]=p):p=e[40];let J;e[41]===Symbol.for("react.memo_cache_sentinel")?(J=t.jsx(ee,{htmlFor:"date_to",children:"To Date"}),e[41]=J):J=e[41];let Z;e[42]===Symbol.for("react.memo_cache_sentinel")?(Z=s=>ue(s.target.value),e[42]=Z):Z=e[42];let g;e[43]!==c?(g=t.jsxs("div",{children:[J,t.jsx(ce,{id:"date_to",type:"date",value:c,onChange:Z})]}),e[43]=c,e[44]=g):g=e[44];let j;e[45]!==p||e[46]!==g?(j=t.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[p,g]}),e[45]=p,e[46]=g,e[47]=j):j=e[47];let b;e[48]!==le||e[49]!==u||e[50]!==j?(b=t.jsx(de,{children:t.jsx(oe,{className:"pt-6",children:t.jsxs("form",{onSubmit:le,className:"space-y-4",children:[u,j]})})}),e[48]=le,e[49]=u,e[50]=j,e[51]=b):b=e[51];let _;e[52]!==ne?(_=()=>ne("created_at"),e[52]=ne,e[53]=_):_=e[53];let q;e[54]===Symbol.for("react.memo_cache_sentinel")?(q=t.jsx(Ve,{className:"h-3 w-3"}),e[54]=q):q=e[54];let N;e[55]!==_?(N=t.jsx("div",{className:"col-span-3",children:t.jsxs("button",{onClick:_,className:"flex items-center gap-1 hover:text-foreground",children:["Time",q]})}),e[55]=_,e[56]=N):N=e[56];let K,Q,W,X;e[57]===Symbol.for("react.memo_cache_sentinel")?(K=t.jsx("div",{className:"col-span-3",children:"Action"}),Q=t.jsx("div",{className:"col-span-2",children:"User"}),W=t.jsx("div",{className:"col-span-2",children:"Business"}),X=t.jsx("div",{className:"col-span-2",children:"Details"}),e[57]=K,e[58]=Q,e[59]=W,e[60]=X):(K=e[57],Q=e[58],W=e[59],X=e[60]);let v;e[61]!==N?(v=t.jsxs("div",{className:"grid grid-cols-12 gap-4 border-b pb-2 text-sm font-medium text-muted-foreground",children:[N,K,Q,W,X]}),e[61]=N,e[62]=v):v=e[62];let y;e[63]!==d||e[64]!==l.data||e[65]!==ie?(y=l.data.length>0?l.data.map(s=>t.jsxs(Fe,{open:d.has(s.id),onOpenChange:()=>ie(s.id),children:[t.jsxs("div",{className:"grid grid-cols-12 gap-4 border-b py-3 text-sm last:border-0",children:[t.jsxs("div",{className:"col-span-3 flex items-center gap-2",children:[t.jsx(Te,{className:"h-4 w-4 text-muted-foreground"}),t.jsx("span",{className:"text-xs",children:ge(s.created_at)})]}),t.jsx("div",{className:"col-span-3",children:t.jsxs("span",{className:`inline-flex items-center gap-1 rounded-full px-2 py-1 text-xs font-medium ${je(s.action)}`,children:[t.jsx(Be,{className:"h-3 w-3"}),s.action]})}),t.jsx("div",{className:"col-span-2 flex items-center gap-2",children:s.user?t.jsxs(t.Fragment,{children:[t.jsx(Ee,{className:"h-4 w-4 text-muted-foreground"}),t.jsx("span",{className:"truncate",title:s.user.email,children:s.user.name})]}):t.jsx("span",{className:"text-muted-foreground",children:"System"})}),t.jsx("div",{className:"col-span-2 flex items-center gap-2",children:s.business?t.jsxs(t.Fragment,{children:[t.jsx(Ue,{className:"h-4 w-4 text-muted-foreground"}),t.jsx("span",{className:"truncate",children:s.business.name})]}):t.jsx("span",{className:"text-muted-foreground",children:"-"})}),t.jsxs("div",{className:"col-span-2 flex items-center justify-between",children:[t.jsx("div",{className:"flex items-center gap-2",children:s.ip_address&&t.jsxs("span",{className:"flex items-center gap-1 text-xs text-muted-foreground",title:"IP Address",children:[t.jsx(Ie,{className:"h-3 w-3"}),s.ip_address]})}),(s.changes||s.model_type)&&t.jsx(Le,{asChild:!0,children:t.jsx(se,{variant:"ghost",size:"sm",children:d.has(s.id)?t.jsx(He,{className:"h-4 w-4"}):t.jsx(ye,{className:"h-4 w-4"})})})]})]}),t.jsx(De,{children:t.jsxs("div",{className:"bg-muted/50 rounded-lg p-4 mb-2 space-y-3",children:[s.model_type&&t.jsxs("div",{children:[t.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Model:"}),t.jsxs("span",{className:"ml-2 text-sm",children:[be(s.model_type)," #",s.model_id]})]}),s.changes&&Object.keys(s.changes).length>0&&t.jsxs("div",{children:[t.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Changes:"}),t.jsx("pre",{className:"mt-1 text-xs bg-background p-2 rounded overflow-x-auto",children:JSON.stringify(s.changes,null,2)})]}),s.user_agent&&t.jsxs("div",{children:[t.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"User Agent:"}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1 break-all",children:s.user_agent})]})]})})]},s.id)):t.jsx("div",{className:"py-8 text-center text-muted-foreground",children:"No audit logs found"}),e[63]=d,e[64]=l.data,e[65]=ie,e[66]=y):y=e[66];let S;e[67]!==v||e[68]!==y?(S=t.jsxs("div",{className:"space-y-2",children:[v,y]}),e[67]=v,e[68]=y,e[69]=S):S=e[69];let C;e[70]!==l.data.length||e[71]!==l.last_page||e[72]!==l.links||e[73]!==l.total?(C=l.last_page>1&&t.jsxs("div",{className:"flex items-center justify-between mt-4 pt-4 border-t",children:[t.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",l.data.length," of ",l.total," logs"]}),t.jsx("div",{className:"flex gap-1",children:l.links.map(Ge)})]}),e[70]=l.data.length,e[71]=l.last_page,e[72]=l.links,e[73]=l.total,e[74]=C):C=e[74];let w;e[75]!==S||e[76]!==C?(w=t.jsx(de,{children:t.jsxs(oe,{className:"pt-6",children:[S,C]})}),e[75]=S,e[76]=C,e[77]=w):w=e[77];let Y;return e[78]!==b||e[79]!==w?(Y=t.jsxs(ke,{breadcrumbs:ze,children:[E,t.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4",children:[I,b,w]})]}),e[78]=b,e[79]=w,e[80]=Y):Y=e[80],Y}function Ge(a,e){return t.jsx(se,{variant:a.active?"default":"outline",size:"sm",disabled:!a.url,onClick:()=>a.url&&te.get(a.url),dangerouslySetInnerHTML:{__html:a.label}},e)}function Pe(a){return t.jsx(me,{value:a,children:a},a)}function Re(a){return a?a.split("\\").pop()||a:"N/A"}function $e(a){return a.includes("create")||a.includes("added")?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":a.includes("delete")||a.includes("removed")||a.includes("banned")?"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200":a.includes("update")||a.includes("changed")?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200"}function Je(a){return new Date(a).toLocaleString("en-ZA",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"})}export{Nt as default};
