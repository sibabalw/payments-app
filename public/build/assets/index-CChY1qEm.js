const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/echo-CLQcSlIV.js","assets/app-zh9bNfQA.js","assets/app-BttOwSmz.css"])))=>i.map(i=>d[i]);
import{r as p,j as e,H as _,L as a,a as c,_ as k}from"./app-zh9bNfQA.js";import{B as l}from"./createLucideIcon-BZjvJ1Zn.js";import{C as x,a as S,b as T,c as h}from"./card-BdZbHl6r.js";import{B as f}from"./badge-VllgXE3C.js";import{A as C}from"./app-layout-Du2zqNOn.js";import{S as E,a as L,b as I,c as P,d as i}from"./select-Bf_U1fyU.js";import{P as V}from"./plus-DPynhUc-.js";import{M as A}from"./message-square-CrR61UD7.js";/* empty css            */import"./app-sidebar-header-CRr_1DPO.js";import"./index-Bvd5418W.js";import"./index-NEtNT4ix.js";import"./x-BIBjS2Dr.js";import"./appearance-dropdown-Bb28oTQN.js";import"./index-BH508O9j.js";import"./chevron-down-C7_CWyHS.js";import"./index-CaEI0-fE.js";import"./index-BJwOBxES.js";import"./index-CcLcdVZM.js";import"./log-out-D2fYovF8.js";import"./chevron-right-O9ILxyvV.js";import"./proxy-CflicfAZ.js";import"./circle-check-B9uKMuXu.js";import"./loader-circle-DmMzF6DP.js";import"./circle-x-BKTi4obl.js";import"./circle-alert-PjDKICDi.js";import"./credit-card-DZtV9Y3R.js";import"./dollar-sign-DV-oRcFJ.js";import"./file-text-DIkPgk9X.js";import"./users-DRMz8fhj.js";import"./user-check-D6rfO7ti.js";import"./clock-CEsoW84B.js";import"./shield-DgxHpXTb.js";import"./index-CvHCqEC4.js";import"./check-BlMOmQr2.js";import"./chevron-up-DTZu2ggr.js";const g=".tickets.list.updated",B=[{title:"Support Tickets",href:"/tickets"}],D={open:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",in_progress:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",closed:"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300"},H={low:"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300",medium:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",high:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300"};function ve({tickets:s,filters:j,auth:d}){const o=p.useRef(null);p.useEffect(()=>{let t=null;const n=1e3,m=d?.user?.id;if(m==null)return;const u=`user.${m}.tickets`,y=()=>{if(!(typeof window>"u"||!window.Echo))try{const r=o.current;r&&typeof r.stopListening=="function"&&r.stopListening(g),window.Echo.leaveChannel(u),o.current=null}catch(r){console.error("WebSocket: Error leaving tickets channel",r)}};return(async()=>{try{const r=(await k(async()=>{const{default:w}=await import("./echo-CLQcSlIV.js");return{default:w}},__vite__mapDeps([0,1,2]))).default(),v=()=>{t&&clearTimeout(t),t=setTimeout(()=>{t=null,c.reload({only:["tickets"]})},n)},N=r.private(u).listen(g,v);o.current=N}catch(r){console.error("Failed to initialize WebSocket:",r)}})(),()=>{t&&clearTimeout(t),y()}},[d?.user?.id]);const b=t=>{c.get("/tickets",{status:t||null})};return e.jsxs(C,{breadcrumbs:B,children:[e.jsx(_,{title:"Support Tickets"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Support Tickets"}),e.jsx(a,{href:"/tickets/create",children:e.jsxs(l,{children:[e.jsx(V,{className:"mr-2 h-4 w-4"}),"New Ticket"]})})]}),e.jsx("div",{className:"flex gap-4",children:e.jsxs(E,{value:j?.status||"all",onValueChange:b,children:[e.jsx(L,{className:"w-[180px]",children:e.jsx(I,{placeholder:"Filter by status"})}),e.jsxs(P,{children:[e.jsx(i,{value:"all",children:"All Statuses"}),e.jsx(i,{value:"open",children:"Open"}),e.jsx(i,{value:"in_progress",children:"In Progress"}),e.jsx(i,{value:"closed",children:"Closed"})]})]})}),s?.data&&s.data.length>0?e.jsx("div",{className:"grid gap-4",children:s.data.map(t=>e.jsxs(x,{className:"hover:shadow-md transition-shadow",children:[e.jsx(S,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(T,{className:"mb-2",children:e.jsx(a,{href:`/tickets/${t.id}`,className:"hover:underline",children:t.subject})}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx(f,{className:D[t.status],children:t.status.replace("_"," ")}),e.jsx(f,{className:H[t.priority],children:t.priority})]})]}),e.jsx(a,{href:`/tickets/${t.id}`,children:e.jsxs(l,{variant:"outline",size:"sm",children:[e.jsx(A,{className:"mr-2 h-4 w-4"}),"View"]})})]})}),e.jsxs(h,{children:[e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:t.description}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Created ",new Date(t.created_at).toLocaleDateString()]})]})]},t.id))}):e.jsx(x,{children:e.jsxs(h,{className:"py-10 text-center",children:[e.jsx("p",{className:"text-muted-foreground",children:"No tickets found."}),e.jsx(a,{href:"/tickets/create",className:"mt-4 inline-block",children:e.jsx(l,{children:"Create your first ticket"})})]})}),s?.links&&e.jsx("div",{className:"flex justify-center gap-2",children:s.links.map((t,n)=>e.jsx(l,{variant:t.active?"default":"outline",size:"sm",onClick:()=>t.url&&c.get(t.url),disabled:!t.url,dangerouslySetInnerHTML:{__html:t.label}},n))})]})]})}export{ve as default};
