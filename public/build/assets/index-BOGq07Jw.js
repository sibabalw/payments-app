import{c as $,j as t,H as Z,L as q}from"./app-BRoNAUIM.js";import{C as l,c as a,a as n,b as c,d as U}from"./card-Bag7gWUQ.js";import{B as M}from"./badge-ZsznMIyW.js";import{A as G}from"./admin-layout-BnJz0fFz.js";import{C as J}from"./chevron-left-uzkLnT6H.js";import{U as K}from"./users-CEYKQlp0.js";import{T as z}from"./triangle-alert-D6PyCIl6.js";import{L as Q}from"./lock-Dth4hMuh.js";import{S as V}from"./shield-Kl3V0fgW.js";import{B as W}from"./ban-DyR2-SzY.js";import{A as X}from"./activity-CuMXqdhx.js";/* empty css            */import"./x-pZV5lkp5.js";import"./app-sidebar-header-BbzcXdQi.js";import"./appearance-dropdown-BEtN_wNg.js";import"./index-CBJSSLbQ.js";import"./index-Cfp_L9w6.js";import"./log-out-MC42nTzo.js";import"./index-BohsM0ZD.js";import"./message-square-CEp_sz_O.js";import"./file-text-FWLsz4T5.js";import"./chart-column-DlXi8TWy.js";const Y=[{title:"Admin",href:"/admin"},{title:"Security Management",href:"/admin/security"}];function Ae(s){const e=$.c(43),{rateLimitConfig:i,failedLogins:r,securityEvents:P,activeSessions:H,suspiciousIPs:N,twoFactorStats:T}=s,O=re;let _;e[0]===Symbol.for("react.memo_cache_sentinel")?(_=t.jsx(Z,{title:"Admin - Security Management"}),e[0]=_):_=e[0];let v;e[1]===Symbol.for("react.memo_cache_sentinel")?(v=t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold",children:"Security Management"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Monitor security events and manage rate limits"})]}),e[1]=v):v=e[1];let w;e[2]===Symbol.for("react.memo_cache_sentinel")?(w=t.jsxs("div",{className:"flex items-center justify-between",children:[v,t.jsx(q,{href:"/admin",children:t.jsxs("button",{className:"inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2",children:[t.jsx(J,{className:"mr-2 h-4 w-4"}),"Back to Dashboard"]})})]}),e[2]=w):w=e[2];let S;e[3]===Symbol.for("react.memo_cache_sentinel")?(S=t.jsxs(n,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(c,{className:"text-sm font-medium",children:"Active Sessions"}),t.jsx(K,{className:"h-4 w-4 text-muted-foreground"})]}),e[3]=S):S=e[3];let d;e[4]!==H?(d=t.jsx("div",{className:"text-2xl font-bold",children:H}),e[4]=H,e[5]=d):d=e[5];let C;e[6]===Symbol.for("react.memo_cache_sentinel")?(C=t.jsx("p",{className:"text-xs text-muted-foreground",children:"Currently active"}),e[6]=C):C=e[6];let m;e[7]!==d?(m=t.jsxs(l,{children:[S,t.jsxs(a,{children:[d,C]})]}),e[7]=d,e[8]=m):m=e[8];let A;e[9]===Symbol.for("react.memo_cache_sentinel")?(A=t.jsxs(n,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(c,{className:"text-sm font-medium",children:"Failed Logins (24h)"}),t.jsx(z,{className:"h-4 w-4 text-red-600"})]}),e[9]=A):A=e[9];let o;e[10]!==r.length?(o=t.jsx("div",{className:"text-2xl font-bold",children:r.length}),e[10]=r.length,e[11]=o):o=e[11];let k;e[12]===Symbol.for("react.memo_cache_sentinel")?(k=t.jsx("p",{className:"text-xs text-muted-foreground",children:"Recent failed attempts"}),e[12]=k):k=e[12];let x;e[13]!==o?(x=t.jsxs(l,{children:[A,t.jsxs(a,{children:[o,k]})]}),e[13]=o,e[14]=x):x=e[14];let L;e[15]===Symbol.for("react.memo_cache_sentinel")?(L=t.jsxs(n,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(c,{className:"text-sm font-medium",children:"2FA Enabled"}),t.jsx(Q,{className:"h-4 w-4 text-muted-foreground"})]}),e[15]=L):L=e[15];let f;e[16]!==T.enabled?(f=t.jsx("div",{className:"text-2xl font-bold",children:T.enabled}),e[16]=T.enabled,e[17]=f):f=e[17];let D;e[18]===Symbol.for("react.memo_cache_sentinel")?(D=t.jsx("p",{className:"text-xs text-muted-foreground",children:"Users with 2FA"}),e[18]=D):D=e[18];let h;e[19]!==f?(h=t.jsxs(l,{children:[L,t.jsxs(a,{children:[f,D]})]}),e[19]=f,e[20]=h):h=e[20];let u;e[21]!==x||e[22]!==h||e[23]!==m?(u=t.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[m,x,h]}),e[21]=x,e[22]=h,e[23]=m,e[24]=u):u=e[24];let F;e[25]===Symbol.for("react.memo_cache_sentinel")?(F=t.jsxs(n,{children:[t.jsxs(c,{className:"flex items-center gap-2",children:[t.jsx(V,{className:"h-5 w-5"}),"Rate Limit Configuration"]}),t.jsx(U,{children:"Current rate limiting settings"})]}),e[25]=F):F=e[25];let p;e[26]!==i?(p=t.jsxs(l,{children:[F,t.jsx(a,{children:t.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:Object.entries(i).map(ie)})})]}),e[26]=i,e[27]=p):p=e[27];let B;e[28]===Symbol.for("react.memo_cache_sentinel")?(B=t.jsxs(n,{children:[t.jsxs(c,{className:"flex items-center gap-2",children:[t.jsx(W,{className:"h-5 w-5"}),"Suspicious IP Addresses"]}),t.jsx(U,{children:"IPs with multiple failed login attempts (7 days)"})]}),e[28]=B):B=e[28];let j;e[29]!==N?(j=t.jsxs(l,{children:[B,t.jsx(a,{children:N.length>0?t.jsx("div",{className:"space-y-3",children:N.map(se)}):t.jsx("p",{className:"text-center text-muted-foreground py-4",children:"No suspicious IPs found"})})]}),e[29]=N,e[30]=j):j=e[30];let E;e[31]===Symbol.for("react.memo_cache_sentinel")?(E=t.jsxs(n,{children:[t.jsxs(c,{className:"flex items-center gap-2",children:[t.jsx(z,{className:"h-5 w-5 text-red-600"}),"Recent Failed Login Attempts"]}),t.jsx(U,{children:"Failed login attempts in the last 24 hours"})]}),e[31]=E):E=e[31];let b;e[32]!==r?(b=t.jsxs(l,{children:[E,t.jsx(a,{children:r.length>0?t.jsx("div",{className:"space-y-3",children:r.slice(0,20).map(y=>t.jsxs("div",{className:"flex items-center justify-between border-b pb-3 last:border-0",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium",children:y.email||`User ID: ${y.user_id||"Unknown"}`}),t.jsxs("p",{className:"text-xs text-muted-foreground",children:[y.ip_address&&t.jsx("span",{className:"font-mono",children:y.ip_address})," â€¢ ",O(y.created_at)]})]}),t.jsx(M,{className:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",children:"Failed"})]},y.id))}):t.jsx("p",{className:"text-center text-muted-foreground py-4",children:"No failed login attempts"})})]}),e[32]=r,e[33]=b):b=e[33];let I;e[34]===Symbol.for("react.memo_cache_sentinel")?(I=t.jsxs(n,{children:[t.jsxs(c,{className:"flex items-center gap-2",children:[t.jsx(X,{className:"h-5 w-5"}),"Security Events Summary (7 Days)"]}),t.jsx(U,{children:"Security-related events by type"})]}),e[34]=I):I=e[34];let g;e[35]!==P?(g=t.jsxs(l,{children:[I,t.jsx(a,{children:t.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:Object.entries(P).map(ee)})})]}),e[35]=P,e[36]=g):g=e[36];let R;return e[37]!==u||e[38]!==p||e[39]!==j||e[40]!==b||e[41]!==g?(R=t.jsxs(G,{breadcrumbs:Y,children:[_,t.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4",children:[w,u,p,j,b,g]})]}),e[37]=u,e[38]=p,e[39]=j,e[40]=b,e[41]=g,e[42]=R):R=e[42],R}function ee(s){const[e,i]=s,r=i.reduce(te,0);return t.jsxs("div",{className:"border rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"font-medium capitalize",children:e.replace(/\./g," ").replace(/_/g," ")}),t.jsx(M,{variant:"secondary",children:r})]}),t.jsxs("p",{className:"text-xs text-muted-foreground",children:[i.length," day",i.length!==1?"s":""," with activity"]})]},e)}function te(s,e){return s+e.count}function se(s){return t.jsxs("div",{className:"flex items-center justify-between border-b pb-3 last:border-0",children:[t.jsx("div",{children:t.jsx("p",{className:"text-sm font-medium font-mono",children:s.ip_address})}),t.jsxs(M,{className:s.attempt_count>10?"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",children:[s.attempt_count," attempts"]})]},s.ip_address)}function ie(s){const[e,i]=s;return t.jsxs("div",{className:"border rounded-lg p-4 space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"font-medium capitalize",children:e.replace("_"," ")}),t.jsxs(M,{variant:"outline",children:[i.max_attempts," attempts"]})]}),t.jsx("p",{className:"text-sm text-muted-foreground",children:i.description}),t.jsx("div",{className:"flex justify-between text-xs text-muted-foreground",children:t.jsxs("span",{children:["Decay: ",i.decay_minutes," minutes"]})})]},e)}function re(s){return new Date(s).toLocaleString("en-ZA",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}export{Ae as default};
