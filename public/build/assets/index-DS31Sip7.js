const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/echo-DDYjJYba.js","assets/app-BRoNAUIM.js","assets/app-L_J-G5SC.css"])))=>i.map(i=>d[i]);
import{r as u,j as e,H as T,L as m,a as o,_ as E}from"./app-BRoNAUIM.js";import{B as x}from"./x-pZV5lkp5.js";import{C as h,a as k,b as A,c as p}from"./card-Bag7gWUQ.js";import{B as c}from"./badge-ZsznMIyW.js";import{A as L}from"./admin-layout-BnJz0fFz.js";import{S as g,a as j,b as f,c as y,d as r}from"./select-Cv0uEHLH.js";import{M as I}from"./message-square-CEp_sz_O.js";/* empty css            */import"./app-sidebar-header-BbzcXdQi.js";import"./appearance-dropdown-BEtN_wNg.js";import"./index-CBJSSLbQ.js";import"./index-Cfp_L9w6.js";import"./log-out-MC42nTzo.js";import"./index-BohsM0ZD.js";import"./shield-Kl3V0fgW.js";import"./users-CEYKQlp0.js";import"./file-text-FWLsz4T5.js";import"./lock-Dth4hMuh.js";import"./chart-column-DlXi8TWy.js";import"./index-CfMSX17F.js";import"./check-CU7v0mdS.js";import"./chevron-up-DDm2opro.js";const b=".tickets.list.updated",v="admin.tickets",P=[{title:"Admin",href:"/admin"},{title:"Tickets",href:"/admin/tickets"}],F={open:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",in_progress:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",closed:"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300"},H={low:"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300",medium:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",high:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300"};function le({tickets:n,filters:t}){const d=u.useRef(null);u.useEffect(()=>{let s=null;const l=1e3,i=()=>{if(!(typeof window>"u"||!window.Echo))try{const a=d.current;a&&typeof a.stopListening=="function"&&a.stopListening(b),window.Echo.leaveChannel(v),d.current=null}catch(a){console.error("WebSocket: Error leaving tickets channel",a)}};return(async()=>{try{const a=(await E(async()=>{const{default:C}=await import("./echo-DDYjJYba.js");return{default:C}},__vite__mapDeps([0,1,2]))).default(),w=()=>{s&&clearTimeout(s),s=setTimeout(()=>{s=null,o.reload({only:["tickets"]})},l)},S=a.private(v).listen(b,w);d.current=S}catch(a){console.error("Failed to initialize WebSocket:",a)}})(),()=>{s&&clearTimeout(s),i()}},[]);const _=s=>{const l=!s||s===""||s==="all"?null:s,i=t?.priority&&t.priority!==""&&t.priority!=="all"?t.priority:null;o.get("/admin/tickets",{status:l,priority:i})},N=s=>{const l=!s||s===""||s==="all"?null:s,i=t?.status&&t.status!==""&&t.status!=="all"?t.status:null;o.get("/admin/tickets",{status:i,priority:l})};return e.jsxs(L,{breadcrumbs:P,children:[e.jsx(T,{title:"Support Tickets - Admin"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h1",{className:"text-2xl font-bold",children:"Support Tickets"})}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs(g,{value:t?.status&&t.status!==""?t.status:"all",onValueChange:_,children:[e.jsx(j,{className:"w-[180px]",children:e.jsx(f,{placeholder:"Filter by status"})}),e.jsxs(y,{children:[e.jsx(r,{value:"all",children:"All Statuses"}),e.jsx(r,{value:"open",children:"Open"}),e.jsx(r,{value:"in_progress",children:"In Progress"}),e.jsx(r,{value:"closed",children:"Closed"})]})]}),e.jsxs(g,{value:t?.priority&&t.priority!==""?t.priority:"all",onValueChange:N,children:[e.jsx(j,{className:"w-[180px]",children:e.jsx(f,{placeholder:"Filter by priority"})}),e.jsxs(y,{children:[e.jsx(r,{value:"all",children:"All Priorities"}),e.jsx(r,{value:"low",children:"Low"}),e.jsx(r,{value:"medium",children:"Medium"}),e.jsx(r,{value:"high",children:"High"})]})]})]}),n?.data&&n.data.length>0?e.jsx("div",{className:"grid gap-4",children:n.data.map(s=>e.jsxs(h,{className:"hover:shadow-md transition-shadow",children:[e.jsx(k,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(A,{className:"mb-2",children:e.jsx(m,{href:`/admin/tickets/${s.id}`,className:"hover:underline",children:s.subject})}),e.jsxs("div",{className:"flex gap-2 flex-wrap mb-2",children:[e.jsx(c,{className:F[s.status],children:s.status.replace("_"," ")}),e.jsx(c,{className:H[s.priority],children:s.priority})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["From: ",s.user?.name," (",s.user?.email,")"]}),s.assigned_to&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Assigned to: ",s.assigned_to?.name]})]}),e.jsx(m,{href:`/admin/tickets/${s.id}`,children:e.jsxs(x,{variant:"outline",size:"sm",children:[e.jsx(I,{className:"mr-2 h-4 w-4"}),"View"]})})]})}),e.jsxs(p,{children:[e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:s.description}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Created ",new Date(s.created_at).toLocaleDateString()]}),s.messages_count>0&&e.jsxs(c,{variant:"outline",children:[s.messages_count," message",s.messages_count!==1?"s":""]})]})]})]},s.id))}):e.jsx(h,{children:e.jsx(p,{className:"py-10 text-center",children:e.jsx("p",{className:"text-muted-foreground",children:"No tickets found."})})}),n?.links&&e.jsx("div",{className:"flex justify-center gap-2",children:n.links.map((s,l)=>e.jsx(x,{variant:s.active?"default":"outline",size:"sm",onClick:()=>s.url&&o.get(s.url),disabled:!s.url,dangerouslySetInnerHTML:{__html:s.label}},l))})]})]})}export{le as default};
