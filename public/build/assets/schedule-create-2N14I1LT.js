import{c as st,r as Be,u as lt,j as t,L as Me,H as it}from"./app-DlRq_5I-.js";import{A as nt}from"./app-layout-B1Fh94R8.js";import{B as We}from"./createLucideIcon-DfICN48Q.js";import{C as Ge,a as Oe,b as Ye,c as ze}from"./card-BpVtH_kK.js";import{I as Je}from"./input-EpzQuicb.js";import{L as o}from"./label-DDSUlu2q.js";import{S as Ze,a as Ee,b as Le,c as Ve,d as X}from"./select-Ba948_P_.js";import{D as rt,i as Ke}from"./date-picker-Bki7HRvB.js";import{C as He}from"./checkbox-CYLpTOnB.js";import{I as p}from"./input-error-N6fjUyr3.js";/* empty css            */import"./app-sidebar-header-DViv9NrM.js";import"./index-BlmLjsw4.js";import"./index-B1IOqWwB.js";import"./x-RYBOgl4T.js";import"./appearance-dropdown-kWEtid9a.js";import"./index-Dl5gb-Kb.js";import"./chevron-down-DBn0VZdD.js";import"./index-D8-tZbVS.js";import"./index-BC94lCP7.js";import"./index-CcLcdVZM.js";import"./log-out-BKe7v_gT.js";import"./chevron-right-FxPRos96.js";import"./badge-DkQNu0Ve.js";import"./proxy-DB18oa0z.js";import"./circle-check-CTpeSp7r.js";import"./loader-circle-DB6syjKq.js";import"./circle-x-DCpd_SlB.js";import"./circle-alert-BMPPz6PA.js";import"./plus-CLDQrfk-.js";import"./credit-card-BEASO8FW.js";import"./dollar-sign-CAhazD9z.js";import"./message-square-BIfa93Ti.js";import"./file-text-DtJO93Xu.js";import"./users-DkXA52Op.js";import"./user-check-BIHcPLhA.js";import"./clock-eJfs3CCo.js";import"./shield-Bc8H0Rwn.js";import"./index-qKkV1P3H.js";import"./check-57gXsznI.js";import"./chevron-up-C3E08OMs.js";import"./calendar-Cq1Ld_Lm.js";import"./format-BS8Ay9AX.js";import"./chevron-left-CeavYiYk.js";import"./calendar-B2gwonc8.js";const at=[{title:"Payments",href:"/payments"},{title:"Create Schedule",href:"#"}];function ls(c){const e=st.c(157),{businesses:x,recipients:f,selectedBusinessId:Qe,escrowBalance:y}=c,Ue=dt(),[a,u]=Be.useState("all");let te;e[0]===Symbol.for("react.memo_cache_sentinel")?(te=[],e[0]=te):te=e[0];const[r,d]=Be.useState(te),Ce=Qe||x?.[0]?.id||"",Xe="",et="recurring",we=Ue.toISOString().split("T");let se;e[1]===Symbol.for("react.memo_cache_sentinel")?(se=[],e[1]=se):se=e[1];let le;e[2]!==Ce||e[3]!==we[0]?(le={business_id:Ce,name:Xe,schedule_type:et,scheduled_date:we[0],scheduled_time:"09:00",frequency:"monthly",amount:"",recipient_ids:se},e[2]=Ce,e[3]=we[0],e[4]=le):le=e[4];const{data:s,setData:i,post:De,processing:ie,errors:n}=lt(le);let ne;e[5]!==s.business_id||e[6]!==i||e[7]!==d||e[8]!==u?(ne=()=>{s.business_id&&(d([]),i("recipient_ids",[]),u("all"))},e[5]=s.business_id,e[6]=i,e[7]=d,e[8]=u,e[9]=ne):ne=e[9];let re;e[10]!==s.business_id?(re=[s.business_id],e[10]=s.business_id,e[11]=re):re=e[11],Be.useEffect(ne,re);let ae;e[12]!==r||e[13]!==i||e[14]!==d?(ae=l=>{if(!r.includes(l.id)){const m=[...r,l.id];d(m),i("recipient_ids",m)}},e[12]=r,e[13]=i,e[14]=d,e[15]=ae):ae=e[15];const Fe=ae;let ce;e[16]!==r||e[17]!==i||e[18]!==d?(ce=l=>{const m=r.filter(ee=>ee!==l);d(m),i("recipient_ids",m)},e[16]=r,e[17]=i,e[18]=d,e[19]=ce):ce=e[19];const Re=ce;let me;e[20]!==De||e[21]!==f||e[22]!==r||e[23]!==i||e[24]!==a?(me=l=>{if(l.preventDefault(),a==="all")if(f&&f.length>0){const m=f.map(mt);i("recipient_ids",m)}else i("recipient_ids",[]);else a==="select"&&i("recipient_ids",r);De("/payments")},e[20]=De,e[21]=f,e[22]=r,e[23]=i,e[24]=a,e[25]=me):me=e[25];const qe=me;let de;e[26]!==f?(de=f||[],e[26]=f,e[27]=de):de=e[27];const h=de;let oe;e[28]===Symbol.for("react.memo_cache_sentinel")?(oe=t.jsx(it,{title:"Create Payment Schedule"}),e[28]=oe):oe=e[28];let ue;e[29]===Symbol.for("react.memo_cache_sentinel")?(ue=t.jsx(Oe,{children:t.jsx(Ye,{children:"Create Payment Schedule"})}),e[29]=ue):ue=e[29];let _;e[30]!==x||e[31]!==s.business_id||e[32]!==n.business_id||e[33]!==i?(_=x&&x.length>0&&t.jsxs("div",{children:[t.jsx(o,{htmlFor:"business_id",children:"Business"}),t.jsxs(Ze,{value:String(s.business_id),onValueChange:l=>i("business_id",l),children:[t.jsx(Ee,{id:"business_id",children:t.jsx(Le,{})}),t.jsx(Ve,{children:x.map(ct)})]}),t.jsx(p,{message:n.business_id})]}),e[30]=x,e[31]=s.business_id,e[32]=n.business_id,e[33]=i,e[34]=_):_=e[34];let he;e[35]===Symbol.for("react.memo_cache_sentinel")?(he=t.jsx(o,{htmlFor:"name",children:"Schedule Name"}),e[35]=he):he=e[35];let j;e[36]!==i?(j=l=>i("name",l.target.value),e[36]=i,e[37]=j):j=e[37];let g;e[38]!==s.name||e[39]!==j?(g=t.jsx(Je,{id:"name",value:s.name,onChange:j,placeholder:"e.g., Monthly Vendor Payments",required:!0}),e[38]=s.name,e[39]=j,e[40]=g):g=e[40];let b;e[41]!==n.name?(b=t.jsx(p,{message:n.name}),e[41]=n.name,e[42]=b):b=e[42];let S;e[43]!==g||e[44]!==b?(S=t.jsxs("div",{children:[he,g,b]}),e[43]=g,e[44]=b,e[45]=S):S=e[45];let fe;e[46]===Symbol.for("react.memo_cache_sentinel")?(fe=t.jsx(o,{htmlFor:"amount",children:"Amount (ZAR)"}),e[46]=fe):fe=e[46];let v;e[47]!==i?(v=l=>i("amount",l.target.value),e[47]=i,e[48]=v):v=e[48];let N;e[49]!==s.amount||e[50]!==v?(N=t.jsx(Je,{id:"amount",type:"number",step:"0.01",min:"0.01",value:s.amount,onChange:v,placeholder:"0.00",required:!0}),e[49]=s.amount,e[50]=v,e[51]=N):N=e[51];let C;e[52]!==n.amount?(C=t.jsx(p,{message:n.amount}),e[52]=n.amount,e[53]=C):C=e[53];let w;e[54]!==N||e[55]!==C?(w=t.jsxs("div",{children:[fe,N,C]}),e[54]=N,e[55]=C,e[56]=w):w=e[56];let pe;e[57]===Symbol.for("react.memo_cache_sentinel")?(pe=t.jsx(o,{htmlFor:"schedule_type",children:"Schedule Type"}),e[57]=pe):pe=e[57];let D;e[58]!==i?(D=l=>i("schedule_type",l),e[58]=i,e[59]=D):D=e[59];let xe;e[60]===Symbol.for("react.memo_cache_sentinel")?(xe=t.jsx(Ee,{children:t.jsx(Le,{})}),e[60]=xe):xe=e[60];let ye;e[61]===Symbol.for("react.memo_cache_sentinel")?(ye=t.jsxs(Ve,{children:[t.jsx(X,{value:"recurring",children:"Recurring Payment"}),t.jsx(X,{value:"one_time",children:"One-time Payment"})]}),e[61]=ye):ye=e[61];let F;e[62]!==s.schedule_type||e[63]!==D?(F=t.jsxs(Ze,{value:s.schedule_type,onValueChange:D,children:[xe,ye]}),e[62]=s.schedule_type,e[63]=D,e[64]=F):F=e[64];let R;e[65]!==n.schedule_type?(R=t.jsx(p,{message:n.schedule_type}),e[65]=n.schedule_type,e[66]=R):R=e[66];const Ae=s.schedule_type==="one_time"?"Payment will execute once at the scheduled time and then be cancelled":"Payment will execute repeatedly based on the selected frequency";let q;e[67]!==Ae?(q=t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:Ae}),e[67]=Ae,e[68]=q):q=e[68];let A;e[69]!==F||e[70]!==R||e[71]!==q?(A=t.jsxs("div",{children:[pe,F,R,q]}),e[69]=F,e[70]=R,e[71]=q,e[72]=A):A=e[72];let _e;e[73]===Symbol.for("react.memo_cache_sentinel")?(_e=t.jsx(o,{children:"Schedule Date & Time"}),e[73]=_e):_e=e[73];let k;e[74]!==s.scheduled_date||e[75]!==s.scheduled_time?(k=s.scheduled_date?(()=>{const[l,m,ee]=s.scheduled_date.split("-").map(Number),[Te,$e]=(s.scheduled_time||"00:00").split(":").map(Number);return new Date(l,m-1,ee,Te,$e)})():void 0,e[74]=s.scheduled_date,e[75]=s.scheduled_time,e[76]=k):k=e[76];let I;e[77]!==i?(I=l=>{if(l){const m=l.getFullYear(),ee=String(l.getMonth()+1).padStart(2,"0"),Te=String(l.getDate()).padStart(2,"0");i("scheduled_date",`${m}-${ee}-${Te}`);const $e=String(l.getHours()).padStart(2,"0"),tt=String(l.getMinutes()).padStart(2,"0");i("scheduled_time",`${$e}:${tt}`)}},e[77]=i,e[78]=I):I=e[78];let P;e[79]!==i?(P=l=>i("scheduled_time",l),e[79]=i,e[80]=P):P=e[80];let T;e[81]!==s.scheduled_time||e[82]!==k||e[83]!==I||e[84]!==P?(T=t.jsx(rt,{date:k,onDateChange:I,time:s.scheduled_time,onTimeChange:P,showTime:!0}),e[81]=s.scheduled_time,e[82]=k,e[83]=I,e[84]=P,e[85]=T):T=e[85];let $;e[86]!==n.scheduled_date?($=t.jsx(p,{message:n.scheduled_date}),e[86]=n.scheduled_date,e[87]=$):$=e[87];let B;e[88]!==n.scheduled_time?(B=t.jsx(p,{message:n.scheduled_time}),e[88]=n.scheduled_time,e[89]=B):B=e[89];let je;e[90]===Symbol.for("react.memo_cache_sentinel")?(je=t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Weekends and South Africa public holidays are not allowed"}),e[90]=je):je=e[90];let Z;e[91]!==T||e[92]!==$||e[93]!==B?(Z=t.jsxs("div",{children:[_e,T,$,B,je]}),e[91]=T,e[92]=$,e[93]=B,e[94]=Z):Z=e[94];let E;e[95]!==s.frequency||e[96]!==s.schedule_type||e[97]!==n.frequency||e[98]!==i?(E=s.schedule_type==="recurring"&&t.jsxs("div",{children:[t.jsx(o,{htmlFor:"frequency",children:"Frequency"}),t.jsxs(Ze,{value:s.frequency,onValueChange:l=>i("frequency",l),children:[t.jsx(Ee,{children:t.jsx(Le,{})}),t.jsxs(Ve,{children:[t.jsx(X,{value:"daily",children:"Daily"}),t.jsx(X,{value:"weekly",children:"Weekly"}),t.jsx(X,{value:"monthly",children:"Monthly"})]})]}),t.jsx(p,{message:n.frequency}),t.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[s.frequency==="daily"&&"Payment will execute every day at the selected time",s.frequency==="weekly"&&"Payment will execute every week on the same weekday at the selected time",s.frequency==="monthly"&&"Payment will execute every month on the same day at the selected time"]})]}),e[95]=s.frequency,e[96]=s.schedule_type,e[97]=n.frequency,e[98]=i,e[99]=E):E=e[99];let ge;e[100]===Symbol.for("react.memo_cache_sentinel")?(ge=t.jsx(o,{children:"Who receives this payment?"}),e[100]=ge):ge=e[100];const ke=a==="all";let L;e[101]!==d||e[102]!==u?(L=l=>{l&&(u("all"),d([]))},e[101]=d,e[102]=u,e[103]=L):L=e[103];let V;e[104]!==ke||e[105]!==L?(V=t.jsx(He,{id:"all_recipients",checked:ke,onCheckedChange:L}),e[104]=ke,e[105]=L,e[106]=V):V=e[106];let be;e[107]===Symbol.for("react.memo_cache_sentinel")?(be=t.jsx(o,{htmlFor:"all_recipients",className:"cursor-pointer font-normal",children:"All Recipients"}),e[107]=be):be=e[107];let H;e[108]!==V?(H=t.jsxs("div",{className:"flex items-center space-x-2",children:[V,be]}),e[108]=V,e[109]=H):H=e[109];const Ie=a==="select";let M;e[110]!==u?(M=l=>{l&&u("select")},e[110]=u,e[111]=M):M=e[111];let W;e[112]!==Ie||e[113]!==M?(W=t.jsx(He,{id:"select_recipients",checked:Ie,onCheckedChange:M}),e[112]=Ie,e[113]=M,e[114]=W):W=e[114];let Se;e[115]===Symbol.for("react.memo_cache_sentinel")?(Se=t.jsx(o,{htmlFor:"select_recipients",className:"cursor-pointer font-normal",children:"Select Recipients"}),e[115]=Se):Se=e[115];let G;e[116]!==W?(G=t.jsxs("div",{className:"flex items-center space-x-2",children:[W,Se]}),e[116]=W,e[117]=G):G=e[117];let O;e[118]!==n.recipient_ids?(O=t.jsx(p,{message:n.recipient_ids}),e[118]=n.recipient_ids,e[119]=O):O=e[119];let Y;e[120]!==H||e[121]!==G||e[122]!==O?(Y=t.jsxs("div",{className:"space-y-4 mt-2",children:[H,G,O]}),e[120]=H,e[121]=G,e[122]=O,e[123]=Y):Y=e[123];let z;e[124]!==s.business_id||e[125]!==h||e[126]!==Fe||e[127]!==Re||e[128]!==r||e[129]!==a?(z=a==="select"&&t.jsxs("div",{className:"space-y-2 mt-4",children:[t.jsx(o,{children:"Select Recipients"}),s.business_id?h.length===0?t.jsxs("p",{className:"text-sm text-muted-foreground",children:["No recipients found for this business. ",t.jsx(Me,{href:"/recipients/create",className:"text-primary underline",children:"Create a recipient"})," first."]}):t.jsx(t.Fragment,{children:t.jsx("div",{className:"space-y-2 max-h-60 overflow-auto border rounded-md p-2",children:h.map(l=>t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(He,{id:`recipient_${l.id}`,checked:r.includes(l.id),onCheckedChange:m=>{m?Fe(l):Re(l.id)}}),t.jsxs(o,{htmlFor:`recipient_${l.id}`,className:"cursor-pointer font-normal flex-1",children:[l.name,l.email&&t.jsxs("span",{className:"text-xs text-muted-foreground ml-2",children:["(",l.email,")"]})]})]},l.id))})}):t.jsx("p",{className:"text-sm text-muted-foreground",children:"Please select a business first."})]}),e[124]=s.business_id,e[125]=h,e[126]=Fe,e[127]=Re,e[128]=r,e[129]=a,e[130]=z):z=e[130];let J;e[131]!==Y||e[132]!==z?(J=t.jsxs("div",{children:[ge,Y,z]}),e[131]=Y,e[132]=z,e[133]=J):J=e[133];let K;e[134]!==s.amount||e[135]!==y||e[136]!==h||e[137]!==r||e[138]!==a?(K=(a==="all"||r.length>0)&&s.amount&&t.jsxs(Ge,{className:"bg-muted",children:[t.jsx(Oe,{children:t.jsx(Ye,{className:"text-lg",children:"Payment Summary"})}),t.jsx(ze,{children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{className:"text-sm",children:[t.jsx("span",{className:"text-muted-foreground",children:"Recipients: "}),t.jsx("span",{className:"font-medium",children:a==="all"?`All recipients (${h.length} total)`:`${r.length} recipient(s) selected`})]}),t.jsxs("p",{className:"text-sm",children:[t.jsx("span",{className:"text-muted-foreground",children:"Amount per recipient: "}),t.jsx("span",{className:"font-medium",children:new Intl.NumberFormat("en-ZA",{style:"currency",currency:"ZAR"}).format(parseFloat(s.amount))})]}),t.jsxs("p",{className:"text-sm",children:[t.jsx("span",{className:"text-muted-foreground",children:"Total amount: "}),t.jsx("span",{className:"font-medium",children:new Intl.NumberFormat("en-ZA",{style:"currency",currency:"ZAR"}).format(parseFloat(s.amount)*(a==="all"?h.length:r.length))})]}),y!=null&&t.jsxs("p",{className:"text-sm mt-2",children:[t.jsx("span",{className:"text-muted-foreground",children:"Available Escrow Balance: "}),t.jsx("span",{className:parseFloat(s.amount)*(a==="all"?h.length:r.length)>y?"text-red-600 font-medium":"",children:new Intl.NumberFormat("en-ZA",{style:"currency",currency:"ZAR"}).format(y)})]})]})})]}),e[134]=s.amount,e[135]=y,e[136]=h,e[137]=r,e[138]=a,e[139]=K):K=e[139];const Pe=ie?"Creating...":"Create Schedule";let Q;e[140]!==ie||e[141]!==Pe?(Q=t.jsx(We,{type:"submit",disabled:ie,children:Pe}),e[140]=ie,e[141]=Pe,e[142]=Q):Q=e[142];let ve;e[143]===Symbol.for("react.memo_cache_sentinel")?(ve=t.jsx(Me,{href:"/payments",children:t.jsx(We,{type:"button",variant:"outline",children:"Cancel"})}),e[143]=ve):ve=e[143];let U;e[144]!==Q?(U=t.jsxs("div",{className:"flex gap-2",children:[Q,ve]}),e[144]=Q,e[145]=U):U=e[145];let Ne;return e[146]!==qe||e[147]!==_||e[148]!==S||e[149]!==w||e[150]!==A||e[151]!==Z||e[152]!==E||e[153]!==J||e[154]!==K||e[155]!==U?(Ne=t.jsxs(nt,{breadcrumbs:at,children:[oe,t.jsx("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4",children:t.jsxs(Ge,{children:[ue,t.jsx(ze,{children:t.jsxs("form",{onSubmit:qe,className:"space-y-4",children:[_,S,w,A,Z,E,J,K,U]})})]})})]}),e[146]=qe,e[147]=_,e[148]=S,e[149]=w,e[150]=A,e[151]=Z,e[152]=E,e[153]=J,e[154]=K,e[155]=U,e[156]=Ne):Ne=e[156],Ne}function ct(c){return t.jsx(X,{value:String(c.id),children:c.name},c.id)}function mt(c){return c.id}function dt(){const c=new Date;if(c.setDate(c.getDate()+1),!Ke(c)){const e=new Date(c);for(;!Ke(e);)e.setDate(e.getDate()+1);return e}return c}export{ls as default};
