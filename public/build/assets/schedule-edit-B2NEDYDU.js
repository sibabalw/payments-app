import{c as Oe,r as we,u as We,j as t,H as Ie,L as Pe}from"./app-DlRq_5I-.js";import{A as Ae}from"./app-layout-B1Fh94R8.js";import{B as Ce}from"./createLucideIcon-DfICN48Q.js";import{C as Ee,c as $e,a as ze,b as Ge}from"./card-BpVtH_kK.js";import{I as Le}from"./input-EpzQuicb.js";import{L as h}from"./label-DDSUlu2q.js";import{S as Ne,a as ke,b as Re,c as Fe,d as te}from"./select-Ba948_P_.js";import{D as Ze}from"./date-picker-Bki7HRvB.js";import{C as qe}from"./checkbox-CYLpTOnB.js";import{I as C}from"./input-error-N6fjUyr3.js";/* empty css            */import"./app-sidebar-header-DViv9NrM.js";import"./index-BlmLjsw4.js";import"./index-B1IOqWwB.js";import"./x-RYBOgl4T.js";import"./appearance-dropdown-kWEtid9a.js";import"./index-Dl5gb-Kb.js";import"./chevron-down-DBn0VZdD.js";import"./index-D8-tZbVS.js";import"./index-BC94lCP7.js";import"./index-CcLcdVZM.js";import"./log-out-BKe7v_gT.js";import"./chevron-right-FxPRos96.js";import"./badge-DkQNu0Ve.js";import"./proxy-DB18oa0z.js";import"./circle-check-CTpeSp7r.js";import"./loader-circle-DB6syjKq.js";import"./circle-x-DCpd_SlB.js";import"./circle-alert-BMPPz6PA.js";import"./plus-CLDQrfk-.js";import"./credit-card-BEASO8FW.js";import"./dollar-sign-CAhazD9z.js";import"./message-square-BIfa93Ti.js";import"./file-text-DtJO93Xu.js";import"./users-DkXA52Op.js";import"./user-check-BIHcPLhA.js";import"./clock-eJfs3CCo.js";import"./shield-Bc8H0Rwn.js";import"./index-qKkV1P3H.js";import"./check-57gXsznI.js";import"./chevron-up-C3E08OMs.js";import"./calendar-Cq1Ld_Lm.js";import"./format-BS8Ay9AX.js";import"./chevron-left-CeavYiYk.js";import"./calendar-B2gwonc8.js";const Be=[{title:"Payments",href:"/payments"},{title:"Edit Schedule",href:"#"}];function Mt(p){const e=Oe.c(157),{schedule:c,businesses:N,recipients:o}=p;let le;e[0]!==c.recipients?(le=c?.recipients?.map(Ke)||[],e[0]=c.recipients,e[1]=le):le=e[1];const x=le,Te=o?.length||0,Ve=Te>0&&x.length===Te,[u,De]=we.useState(Ve?"all":"select"),[d,xe]=we.useState(x),fe=c?.scheduled_time||"09:00",k=c?.parsed_frequency||"monthly",_e=c?.business_id??"",je=c?.name??"",ye=c?.schedule_type??"recurring",ge=c?.scheduled_date??"",be=c?.amount??"",Se=c?.currency??"ZAR";let ie;e[2]!==fe||e[3]!==k||e[4]!==x||e[5]!==_e||e[6]!==je||e[7]!==ye||e[8]!==ge||e[9]!==be||e[10]!==Se?(ie={business_id:_e,name:je,schedule_type:ye,scheduled_date:ge,scheduled_time:fe,frequency:k,amount:be,currency:Se,recipient_ids:x},e[2]=fe,e[3]=k,e[4]=x,e[5]=_e,e[6]=je,e[7]=ye,e[8]=ge,e[9]=be,e[10]=Se,e[11]=ie):ie=e[11];const{data:s,setData:l,put:se,processing:ne,errors:r}=We(ie);let R,F,q,T,D,w,i,I,f,_,j,y,g,b,P,A,S,E,$,L;if(e[12]!==N||e[13]!==s.amount||e[14]!==s.business_id||e[15]!==s.name||e[16]!==s.schedule_type||e[17]!==s.scheduled_date||e[18]!==s.scheduled_time||e[19]!==r||e[20]!==se||e[21]!==o||e[22]!==c||e[23]!==d||e[24]!==l||e[25]!==u){$=Symbol.for("react.early_return_sentinel");e:{const a=s.scheduled_date?new Date(s.scheduled_date+"T"+(s.scheduled_time||"00:00")):void 0;i=c?.status==="cancelled";let Y;e[46]!==d||e[47]!==l?(Y=n=>{if(!d.includes(n.id)){const m=[...d,n.id];xe(m),l("recipient_ids",m)}},e[46]=d,e[47]=l,e[48]=Y):Y=e[48],D=Y;let ae;e[49]!==d||e[50]!==l?(ae=n=>{const m=d.filter(v=>v!==n);xe(m),l("recipient_ids",m)},e[49]=d,e[50]=l,e[51]=ae):ae=e[51],w=ae;let de;e[52]!==se||e[53]!==o||e[54]!==c.id||e[55]!==d||e[56]!==l||e[57]!==u?(de=n=>{n.preventDefault(),u==="all"&&o?.length?l("recipient_ids",o.map(Je)):l("recipient_ids",d),se(`/payments/${c.id}`)},e[52]=se,e[53]=o,e[54]=c.id,e[55]=d,e[56]=l,e[57]=u,e[58]=de):de=e[58];const He=de;let me;if(e[59]!==o?(me=o||[],e[59]=o,e[60]=me):me=e[60],T=me,!c){let n;e[61]===Symbol.for("react.memo_cache_sentinel")?(n=t.jsx(Ie,{title:"Edit Payment Schedule"}),e[61]=n):n=e[61];let m;e[62]===Symbol.for("react.memo_cache_sentinel")?(m=t.jsx("p",{className:"text-muted-foreground",children:"Schedule not found."}),e[62]=m):m=e[62];let v;e[63]===Symbol.for("react.memo_cache_sentinel")?(v=t.jsxs(Ae,{breadcrumbs:Be,children:[n,t.jsx("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4",children:t.jsx(Ee,{children:t.jsxs($e,{className:"py-10 text-center",children:[m,t.jsx(Pe,{href:"/payments",className:"mt-4 inline-block",children:t.jsx(Ce,{variant:"outline",children:"Back to Payments"})})]})})})]}),e[63]=v):v=e[63],$=v;break e}q=Ae,A=Be,e[64]===Symbol.for("react.memo_cache_sentinel")?(S=t.jsx(Ie,{title:"Edit Payment Schedule"}),e[64]=S):S=e[64],P="flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4",F=Ee,e[65]===Symbol.for("react.memo_cache_sentinel")?(b=t.jsx(ze,{children:t.jsx(Ge,{children:"Edit Payment Schedule"})}),e[65]=b):b=e[65],R=$e,L=He,I="space-y-4",e[66]!==N||e[67]!==s.business_id||e[68]!==r.business_id||e[69]!==i||e[70]!==l?(f=N?.length>0&&t.jsxs("div",{children:[t.jsx(h,{htmlFor:"business_id",children:"Business"}),t.jsxs(Ne,{value:String(s.business_id),onValueChange:n=>l("business_id",n),disabled:i,children:[t.jsx(ke,{id:"business_id",children:t.jsx(Re,{})}),t.jsx(Fe,{children:N.map(Ye)})]}),t.jsx(C,{message:r.business_id})]}),e[66]=N,e[67]=s.business_id,e[68]=r.business_id,e[69]=i,e[70]=l,e[71]=f):f=e[71];let oe;e[72]===Symbol.for("react.memo_cache_sentinel")?(oe=t.jsx(h,{htmlFor:"name",children:"Schedule Name"}),e[72]=oe):oe=e[72];let J;e[73]!==l?(J=n=>l("name",n.target.value),e[73]=l,e[74]=J):J=e[74];let K;e[75]!==s.name||e[76]!==i||e[77]!==J?(K=t.jsx(Le,{id:"name",value:s.name,onChange:J,placeholder:"e.g., Monthly Vendor Payments",required:!0,disabled:i}),e[75]=s.name,e[76]=i,e[77]=J,e[78]=K):K=e[78];let Q;e[79]!==r.name?(Q=t.jsx(C,{message:r.name}),e[79]=r.name,e[80]=Q):Q=e[80],e[81]!==K||e[82]!==Q?(_=t.jsxs("div",{children:[oe,K,Q]}),e[81]=K,e[82]=Q,e[83]=_):_=e[83];let ue;e[84]===Symbol.for("react.memo_cache_sentinel")?(ue=t.jsx(h,{htmlFor:"amount",children:"Amount (ZAR)"}),e[84]=ue):ue=e[84];let U;e[85]!==l?(U=n=>l("amount",n.target.value),e[85]=l,e[86]=U):U=e[86];let X;e[87]!==s.amount||e[88]!==i||e[89]!==U?(X=t.jsx(Le,{id:"amount",type:"number",step:"0.01",min:"0.01",value:s.amount,onChange:U,required:!0,disabled:i}),e[87]=s.amount,e[88]=i,e[89]=U,e[90]=X):X=e[90];let ee;e[91]!==r.amount?(ee=t.jsx(C,{message:r.amount}),e[91]=r.amount,e[92]=ee):ee=e[92],e[93]!==X||e[94]!==ee?(j=t.jsxs("div",{children:[ue,X,ee]}),e[93]=X,e[94]=ee,e[95]=j):j=e[95];let he;e[96]===Symbol.for("react.memo_cache_sentinel")?(he=t.jsx(h,{htmlFor:"schedule_type",children:"Schedule Type"}),e[96]=he):he=e[96],e[97]!==s.schedule_type||e[98]!==r.schedule_type||e[99]!==i||e[100]!==l?(y=t.jsxs("div",{children:[he,i?t.jsx("p",{className:"text-sm text-muted-foreground mt-2 capitalize",children:s.schedule_type==="one_time"?"One-time":"Recurring"}):t.jsxs(t.Fragment,{children:[t.jsxs(Ne,{value:s.schedule_type,onValueChange:n=>l("schedule_type",n),children:[t.jsx(ke,{children:t.jsx(Re,{})}),t.jsxs(Fe,{children:[t.jsx(te,{value:"recurring",children:"Recurring Payment"}),t.jsx(te,{value:"one_time",children:"One-time Payment"})]})]}),t.jsx(C,{message:r.schedule_type})]})]}),e[97]=s.schedule_type,e[98]=r.schedule_type,e[99]=i,e[100]=l,e[101]=y):y=e[101],e[102]!==c.next_run_at_missing?(g=c?.next_run_at_missing&&t.jsx("div",{className:"rounded-md border border-amber-200 bg-amber-50 px-3 py-2 text-sm text-amber-800 dark:border-amber-800 dark:bg-amber-950/30 dark:text-amber-200",children:"Next run not set. Set a date and time below and save to recalculate."}),e[102]=c.next_run_at_missing,e[103]=g):g=e[103];let pe;e[104]===Symbol.for("react.memo_cache_sentinel")?(pe=t.jsx(h,{children:"Schedule Date & Time"}),e[104]=pe):pe=e[104],E=t.jsxs("div",{children:[pe,i?t.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:[a?a.toLocaleDateString():"N/A"," at ",s.scheduled_time]}):t.jsxs(t.Fragment,{children:[t.jsx(Ze,{date:a,onDateChange:n=>{if(n){const m=n.getFullYear(),v=String(n.getMonth()+1).padStart(2,"0"),Me=String(n.getDate()).padStart(2,"0");l("scheduled_date",`${m}-${v}-${Me}`)}else l("scheduled_date","")},time:s.scheduled_time,onTimeChange:n=>l("scheduled_time",n),showTime:!0}),t.jsx(C,{message:r.scheduled_date}),t.jsx(C,{message:r.scheduled_time})]})]})}e[12]=N,e[13]=s.amount,e[14]=s.business_id,e[15]=s.name,e[16]=s.schedule_type,e[17]=s.scheduled_date,e[18]=s.scheduled_time,e[19]=r,e[20]=se,e[21]=o,e[22]=c,e[23]=d,e[24]=l,e[25]=u,e[26]=R,e[27]=F,e[28]=q,e[29]=T,e[30]=D,e[31]=w,e[32]=i,e[33]=I,e[34]=f,e[35]=_,e[36]=j,e[37]=y,e[38]=g,e[39]=b,e[40]=P,e[41]=A,e[42]=S,e[43]=E,e[44]=$,e[45]=L}else R=e[26],F=e[27],q=e[28],T=e[29],D=e[30],w=e[31],i=e[32],I=e[33],f=e[34],_=e[35],j=e[36],y=e[37],g=e[38],b=e[39],P=e[40],A=e[41],S=e[42],E=e[43],$=e[44],L=e[45];if($!==Symbol.for("react.early_return_sentinel"))return $;let B;e[105]!==s.frequency||e[106]!==s.schedule_type||e[107]!==r.frequency||e[108]!==i||e[109]!==k||e[110]!==l?(B=s.schedule_type==="recurring"&&t.jsxs("div",{children:[t.jsx(h,{htmlFor:"frequency",children:"Frequency"}),i?t.jsx("p",{className:"text-sm text-muted-foreground mt-2 capitalize",children:k}):t.jsxs(t.Fragment,{children:[t.jsxs(Ne,{value:s.frequency,onValueChange:a=>l("frequency",a),children:[t.jsx(ke,{children:t.jsx(Re,{})}),t.jsxs(Fe,{children:[t.jsx(te,{value:"daily",children:"Daily"}),t.jsx(te,{value:"weekly",children:"Weekly"}),t.jsx(te,{value:"monthly",children:"Monthly"})]})]}),t.jsx(C,{message:r.frequency})]})]}),e[105]=s.frequency,e[106]=s.schedule_type,e[107]=r.frequency,e[108]=i,e[109]=k,e[110]=l,e[111]=B):B=e[111];let re;e[112]===Symbol.for("react.memo_cache_sentinel")?(re=t.jsx(h,{children:"Who receives this payment?"}),e[112]=re):re=e[112];let V;e[113]!==r.recipient_ids||e[114]!==T||e[115]!==D||e[116]!==w||e[117]!==i||e[118]!==x||e[119]!==d||e[120]!==u?(V=t.jsxs("div",{children:[re,i?t.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:[x.length," recipient(s) selected"]}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"space-y-4 mt-2",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(qe,{id:"all_recipients",checked:u==="all",onCheckedChange:a=>{a&&(De("all"),xe([]))}}),t.jsx(h,{htmlFor:"all_recipients",className:"cursor-pointer font-normal",children:"All Recipients"})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(qe,{id:"select_recipients",checked:u==="select",onCheckedChange:a=>{a&&De("select")}}),t.jsx(h,{htmlFor:"select_recipients",className:"cursor-pointer font-normal",children:"Select Recipients"})]})]}),t.jsx(C,{message:r.recipient_ids}),u==="select"&&t.jsx("div",{className:"space-y-2 mt-4 max-h-60 overflow-auto border rounded-md p-2",children:T.map(a=>t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(qe,{id:`recipient_${a.id}`,checked:d.includes(a.id),onCheckedChange:Y=>{Y?D(a):w(a.id)}}),t.jsxs(h,{htmlFor:`recipient_${a.id}`,className:"cursor-pointer font-normal flex-1",children:[a.name,a.email&&t.jsxs("span",{className:"text-xs text-muted-foreground ml-2",children:["(",a.email,")"]})]})]},a.id))})]})]}),e[113]=r.recipient_ids,e[114]=T,e[115]=D,e[116]=w,e[117]=i,e[118]=x,e[119]=d,e[120]=u,e[121]=V):V=e[121];let H;e[122]!==i||e[123]!==ne?(H=!i&&t.jsx(Ce,{type:"submit",disabled:ne,children:ne?"Saving...":"Save Changes"}),e[122]=i,e[123]=ne,e[124]=H):H=e[124];const ve=i?"Back":"Cancel";let M;e[125]!==ve?(M=t.jsx(Pe,{href:"/payments",children:t.jsx(Ce,{type:"button",variant:"outline",children:ve})}),e[125]=ve,e[126]=M):M=e[126];let O;e[127]!==H||e[128]!==M?(O=t.jsxs("div",{className:"flex gap-2",children:[H,M]}),e[127]=H,e[128]=M,e[129]=O):O=e[129];let W;e[130]!==I||e[131]!==f||e[132]!==_||e[133]!==j||e[134]!==y||e[135]!==g||e[136]!==E||e[137]!==B||e[138]!==V||e[139]!==O||e[140]!==L?(W=t.jsxs("form",{onSubmit:L,className:I,children:[f,_,j,y,g,E,B,V,O]}),e[130]=I,e[131]=f,e[132]=_,e[133]=j,e[134]=y,e[135]=g,e[136]=E,e[137]=B,e[138]=V,e[139]=O,e[140]=L,e[141]=W):W=e[141];let z;e[142]!==R||e[143]!==W?(z=t.jsx(R,{children:W}),e[142]=R,e[143]=W,e[144]=z):z=e[144];let G;e[145]!==F||e[146]!==b||e[147]!==z?(G=t.jsxs(F,{children:[b,z]}),e[145]=F,e[146]=b,e[147]=z,e[148]=G):G=e[148];let Z;e[149]!==P||e[150]!==G?(Z=t.jsx("div",{className:P,children:G}),e[149]=P,e[150]=G,e[151]=Z):Z=e[151];let ce;return e[152]!==q||e[153]!==A||e[154]!==S||e[155]!==Z?(ce=t.jsxs(q,{breadcrumbs:A,children:[S,Z]}),e[152]=q,e[153]=A,e[154]=S,e[155]=Z,e[156]=ce):ce=e[156],ce}function Ye(p){return t.jsx(te,{value:String(p.id),children:p.name},p.id)}function Je(p){return p.id}function Ke(p){return p.id}export{Mt as default};
