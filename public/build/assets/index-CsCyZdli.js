const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/echo-CLQcSlIV.js","assets/app-zh9bNfQA.js","assets/app-BttOwSmz.css"])))=>i.map(i=>d[i]);
import{r as m,j as e,H as T,L as u,a as o,_ as E}from"./app-zh9bNfQA.js";import{B as x}from"./createLucideIcon-BZjvJ1Zn.js";import{C as p,a as k,b as A,c as h}from"./card-BdZbHl6r.js";import{B as c}from"./badge-VllgXE3C.js";import{A as L}from"./admin-layout-BWrldFRv.js";import{S as g,a as j,b as f,c as y,d as r}from"./select-Bf_U1fyU.js";import{M as I}from"./message-square-CrR61UD7.js";/* empty css            */import"./app-sidebar-header-CRr_1DPO.js";import"./index-Bvd5418W.js";import"./index-NEtNT4ix.js";import"./x-BIBjS2Dr.js";import"./appearance-dropdown-Bb28oTQN.js";import"./index-BH508O9j.js";import"./chevron-down-C7_CWyHS.js";import"./index-CaEI0-fE.js";import"./index-BJwOBxES.js";import"./index-CcLcdVZM.js";import"./log-out-D2fYovF8.js";import"./chevron-right-O9ILxyvV.js";import"./shield-DgxHpXTb.js";import"./users-DRMz8fhj.js";import"./file-text-DIkPgk9X.js";import"./lock-BsRQ3mjQ.js";import"./credit-card-DZtV9Y3R.js";import"./chart-column-S0VcatN5.js";import"./index-CvHCqEC4.js";import"./check-BlMOmQr2.js";import"./chevron-up-DTZu2ggr.js";const b=".tickets.list.updated",v="admin.tickets",P=[{title:"Admin",href:"/admin"},{title:"Tickets",href:"/admin/tickets"}],F={open:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",in_progress:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",closed:"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300"},H={low:"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300",medium:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",high:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300"};function ue({tickets:n,filters:s}){const d=m.useRef(null);m.useEffect(()=>{let t=null;const l=1e3,i=()=>{if(!(typeof window>"u"||!window.Echo))try{const a=d.current;a&&typeof a.stopListening=="function"&&a.stopListening(b),window.Echo.leaveChannel(v),d.current=null}catch(a){console.error("WebSocket: Error leaving tickets channel",a)}};return(async()=>{try{const a=(await E(async()=>{const{default:C}=await import("./echo-CLQcSlIV.js");return{default:C}},__vite__mapDeps([0,1,2]))).default(),w=()=>{t&&clearTimeout(t),t=setTimeout(()=>{t=null,o.reload({only:["tickets"]})},l)},S=a.private(v).listen(b,w);d.current=S}catch(a){console.error("Failed to initialize WebSocket:",a)}})(),()=>{t&&clearTimeout(t),i()}},[]);const _=t=>{const l=!t||t===""||t==="all"?null:t,i=s?.priority&&s.priority!==""&&s.priority!=="all"?s.priority:null;o.get("/admin/tickets",{status:l,priority:i})},N=t=>{const l=!t||t===""||t==="all"?null:t,i=s?.status&&s.status!==""&&s.status!=="all"?s.status:null;o.get("/admin/tickets",{status:i,priority:l})};return e.jsxs(L,{breadcrumbs:P,children:[e.jsx(T,{title:"Support Tickets - Admin"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h1",{className:"text-2xl font-bold",children:"Support Tickets"})}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs(g,{value:s?.status&&s.status!==""?s.status:"all",onValueChange:_,children:[e.jsx(j,{className:"w-[180px]",children:e.jsx(f,{placeholder:"Filter by status"})}),e.jsxs(y,{children:[e.jsx(r,{value:"all",children:"All Statuses"}),e.jsx(r,{value:"open",children:"Open"}),e.jsx(r,{value:"in_progress",children:"In Progress"}),e.jsx(r,{value:"closed",children:"Closed"})]})]}),e.jsxs(g,{value:s?.priority&&s.priority!==""?s.priority:"all",onValueChange:N,children:[e.jsx(j,{className:"w-[180px]",children:e.jsx(f,{placeholder:"Filter by priority"})}),e.jsxs(y,{children:[e.jsx(r,{value:"all",children:"All Priorities"}),e.jsx(r,{value:"low",children:"Low"}),e.jsx(r,{value:"medium",children:"Medium"}),e.jsx(r,{value:"high",children:"High"})]})]})]}),n?.data&&n.data.length>0?e.jsx("div",{className:"grid gap-4",children:n.data.map(t=>e.jsxs(p,{className:"hover:shadow-md transition-shadow",children:[e.jsx(k,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(A,{className:"mb-2",children:e.jsx(u,{href:`/admin/tickets/${t.id}`,className:"hover:underline",children:t.subject})}),e.jsxs("div",{className:"flex gap-2 flex-wrap mb-2",children:[e.jsx(c,{className:F[t.status],children:t.status.replace("_"," ")}),e.jsx(c,{className:H[t.priority],children:t.priority})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["From: ",t.user?.name," (",t.user?.email,")"]}),t.assigned_to&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Assigned to: ",t.assigned_to?.name]})]}),e.jsx(u,{href:`/admin/tickets/${t.id}`,children:e.jsxs(x,{variant:"outline",size:"sm",children:[e.jsx(I,{className:"mr-2 h-4 w-4"}),"View"]})})]})}),e.jsxs(h,{children:[e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:t.description}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Created ",new Date(t.created_at).toLocaleDateString()]}),t.messages_count>0&&e.jsxs(c,{variant:"outline",children:[t.messages_count," message",t.messages_count!==1?"s":""]})]})]})]},t.id))}):e.jsx(p,{children:e.jsx(h,{className:"py-10 text-center",children:e.jsx("p",{className:"text-muted-foreground",children:"No tickets found."})})}),n?.links&&e.jsx("div",{className:"flex justify-center gap-2",children:n.links.map((t,l)=>e.jsx(x,{variant:t.active?"default":"outline",size:"sm",onClick:()=>t.url&&o.get(t.url),disabled:!t.url,dangerouslySetInnerHTML:{__html:t.label}},l))})]})]})}export{ue as default};
