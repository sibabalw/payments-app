import{c as we,r as Q,j as t,L as re,a as ie,H as he}from"./app-CMeUrf50.js";import{B as m}from"./x-CZYrHTRQ.js";import{C as i,c as n,a as ne,b as ce,d as fe}from"./card-Cwxw5GdZ.js";import{B as W}from"./badge-CpbHZjhE.js";import{a as ke,b as ve,c as Pe,S as Re,d as Te}from"./select-BU5oTjNs.js";import{C as ue}from"./checkbox-tAXJ8-6B.js";import{A as je}from"./app-layout-nNCjU6Ur.js";import{U as de}from"./users-BjCKGoHP.js";import{F as pe}from"./file-text-DBGV6D9F.js";import{R as be}from"./refresh-cw-B5SMkV_1.js";import{S as Ie}from"./square-pen-aSTO4rOJ.js";import{D as Ee}from"./download-AkOmEEhB.js";import{A as Ae}from"./arrow-left-CzAuMvEG.js";import{C as Ge}from"./calendar-B4DGO74h.js";import{C as Fe}from"./circle-check-Bv3Kk_K_.js";/* empty css            */import"./index-BQCSxHRW.js";import"./index-wVJuMR_H.js";import"./check-DXgzueCv.js";import"./chevron-up-B8DO_JqK.js";import"./appearance-dropdown-CIplfUHR.js";import"./app-sidebar-header-CztvwVfL.js";import"./index-CASGKN-W.js";import"./index-Cfp_L9w6.js";import"./log-out-C9Jhd31W.js";import"./proxy-B-sAeQ2V.js";import"./loader-circle-PC8s1h8o.js";import"./circle-x-qFpOssZO.js";import"./circle-alert-tomiUAeh.js";import"./plus-BJ4kQvgy.js";import"./dollar-sign-3i0DvXHD.js";import"./message-square-Bem12P6R.js";import"./user-check-B_uMkO9r.js";import"./clock-C3FzQv_v.js";import"./shield-CzJFJRG5.js";const ge=[{title:"Compliance",href:"/compliance"},{title:"IRP5 Certificates",href:"/compliance/irp5"}];function _t(a){const e=we.c(69),{business:w,employees:l,taxYears:X,selectedTaxYear:Ne,generatedCount:ee,pendingCount:te}=a,[r,_e]=Q.useState(Ne);let k;e[0]===Symbol.for("react.memo_cache_sentinel")?(k=[],e[0]=k):k=e[0];const[d,v]=Q.useState(k),[P,me]=Q.useState(!1),[R,oe]=Q.useState(!1),xe=ze;let T;e[1]===Symbol.for("react.memo_cache_sentinel")?(T=s=>{_e(s),v([]),ie.get("/compliance/irp5",{tax_year:s},{preserveState:!0})},e[1]=T):T=e[1];const Se=T;let I;e[2]!==r?(I=s=>{me(!0),ie.post(`/compliance/irp5/generate/${s}`,{tax_year:r},{onFinish:()=>me(!1)})},e[2]=r,e[3]=I):I=e[3];const E=I;let A;e[4]!==r?(A=()=>{oe(!0),ie.post("/compliance/irp5/generate-bulk",{tax_year:r},{onFinish:()=>oe(!1)})},e[4]=r,e[5]=A):A=e[5];const se=A;let G;e[6]!==l||e[7]!==d.length?(G=()=>{d.length===l.length?v([]):v(l.map(De))},e[6]=l,e[7]=d.length,e[8]=G):G=e[8];const le=G;let F;e[9]===Symbol.for("react.memo_cache_sentinel")?(F=s=>{v(c=>c.includes(s)?c.filter(C=>C!==s):[...c,s])},e[9]=F):F=e[9];const ye=F,Ce=Ye;if(!w){let s;e[10]===Symbol.for("react.memo_cache_sentinel")?(s=t.jsx(he,{title:"IRP5 Certificates"}),e[10]=s):s=e[10];let c,C,K;e[11]===Symbol.for("react.memo_cache_sentinel")?(C=t.jsx(pe,{className:"h-12 w-12 text-muted-foreground mb-4"}),K=t.jsx("h2",{className:"text-xl font-semibold mb-2",children:"No Business Selected"}),c=t.jsx("p",{className:"text-muted-foreground text-center mb-4",children:"Please select a business to manage IRP5 certificates."}),e[11]=c,e[12]=C,e[13]=K):(c=e[11],C=e[12],K=e[13]);let O;return e[14]===Symbol.for("react.memo_cache_sentinel")?(O=t.jsxs(je,{breadcrumbs:ge,children:[s,t.jsx("div",{className:"flex h-full flex-1 flex-col gap-4 p-4",children:t.jsx(i,{children:t.jsxs(n,{className:"flex flex-col items-center justify-center py-12",children:[C,K,c,t.jsx(m,{asChild:!0,children:t.jsx(re,{href:"/businesses",children:"Go to Businesses"})})]})})})]}),e[14]=O):O=e[14],O}let B;e[15]===Symbol.for("react.memo_cache_sentinel")?(B=t.jsx(he,{title:"IRP5 Certificates"}),e[15]=B):B=e[15];let Y,D;e[16]===Symbol.for("react.memo_cache_sentinel")?(Y=t.jsx(m,{variant:"ghost",size:"icon",asChild:!0,children:t.jsx(re,{href:"/compliance",children:t.jsx(Ae,{className:"h-4 w-4"})})}),D=t.jsx("h1",{className:"text-2xl font-bold",children:"IRP5 Tax Certificates"}),e[16]=Y,e[17]=D):(Y=e[16],D=e[17]);let o;e[18]!==w.name?(o=t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{className:"flex items-center gap-4",children:[Y,t.jsxs("div",{children:[D,t.jsxs("p",{className:"text-muted-foreground",children:["Generate annual employee tax certificates for ",w.name]})]})]})}),e[18]=w.name,e[19]=o):o=e[19];let z;e[20]===Symbol.for("react.memo_cache_sentinel")?(z=t.jsxs(ne,{children:[t.jsxs(ce,{className:"flex items-center gap-2",children:[t.jsx(Ge,{className:"h-5 w-5"}),"Tax Year Selection"]}),t.jsx(fe,{children:"Select a tax year to view and generate IRP5 certificates"})]}),e[20]=z):z=e[20];let L;e[21]===Symbol.for("react.memo_cache_sentinel")?(L=t.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Tax Year"}),e[21]=L):L=e[21];let $;e[22]===Symbol.for("react.memo_cache_sentinel")?($=t.jsx(ke,{children:t.jsx(ve,{placeholder:"Select tax year"})}),e[22]=$):$=e[22];let x;e[23]!==X?(x=X.map(Be),e[23]=X,e[24]=x):x=e[24];let h;e[25]!==x?(h=t.jsx(Pe,{children:x}),e[25]=x,e[26]=h):h=e[26];let f;e[27]!==h||e[28]!==r?(f=t.jsxs("div",{className:"flex-1 min-w-[200px] max-w-[300px]",children:[L,t.jsxs(Re,{value:r,onValueChange:Se,children:[$,h]})]}),e[27]=h,e[28]=r,e[29]=f):f=e[29];const ae=R||l.length===0;let u;e[30]!==R?(u=R?t.jsxs(t.Fragment,{children:[t.jsx(be,{className:"mr-2 h-4 w-4 animate-spin"}),"Generating..."]}):t.jsxs(t.Fragment,{children:[t.jsx(de,{className:"mr-2 h-4 w-4"}),"Generate All Certificates"]}),e[30]=R,e[31]=u):u=e[31];let j;e[32]!==se||e[33]!==ae||e[34]!==u?(j=t.jsx(m,{onClick:se,disabled:ae,children:u}),e[32]=se,e[33]=ae,e[34]=u,e[35]=j):j=e[35];let p;e[36]!==f||e[37]!==j?(p=t.jsxs(i,{children:[z,t.jsx(n,{children:t.jsxs("div",{className:"flex flex-wrap gap-4 items-end",children:[f,j]})})]}),e[36]=f,e[37]=j,e[38]=p):p=e[38];let H;e[39]===Symbol.for("react.memo_cache_sentinel")?(H=t.jsx("p",{className:"text-sm text-muted-foreground",children:"Tax Year"}),e[39]=H):H=e[39];let b;e[40]!==r?(b=t.jsx(i,{children:t.jsxs(n,{className:"pt-6",children:[H,t.jsx("p",{className:"text-2xl font-bold",children:r})]})}),e[40]=r,e[41]=b):b=e[41];let M;e[42]===Symbol.for("react.memo_cache_sentinel")?(M=t.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Employees"}),e[42]=M):M=e[42];let g;e[43]!==l.length?(g=t.jsx(i,{children:t.jsxs(n,{className:"pt-6",children:[M,t.jsx("p",{className:"text-2xl font-bold",children:l.length})]})}),e[43]=l.length,e[44]=g):g=e[44];let U;e[45]===Symbol.for("react.memo_cache_sentinel")?(U=t.jsx("p",{className:"text-sm text-muted-foreground",children:"Certificates Generated"}),e[45]=U):U=e[45];let N;e[46]!==ee?(N=t.jsx(i,{className:"border-green-200 bg-green-50 dark:border-green-800 dark:bg-green-950",children:t.jsxs(n,{className:"pt-6",children:[U,t.jsx("p",{className:"text-2xl font-bold text-green-600",children:ee})]})}),e[46]=ee,e[47]=N):N=e[47];let V;e[48]===Symbol.for("react.memo_cache_sentinel")?(V=t.jsx("p",{className:"text-sm text-muted-foreground",children:"Pending"}),e[48]=V):V=e[48];let _;e[49]!==te?(_=t.jsx(i,{className:"border-amber-200 bg-amber-50 dark:border-amber-800 dark:bg-amber-950",children:t.jsxs(n,{className:"pt-6",children:[V,t.jsx("p",{className:"text-2xl font-bold text-amber-600",children:te})]})}),e[49]=te,e[50]=_):_=e[50];let S;e[51]!==b||e[52]!==g||e[53]!==N||e[54]!==_?(S=t.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[b,g,N,_]}),e[51]=b,e[52]=g,e[53]=N,e[54]=_,e[55]=S):S=e[55];let y;e[56]!==l||e[57]!==P||e[58]!==E||e[59]!==le||e[60]!==d?(y=l.length>0?t.jsxs(i,{children:[t.jsxs(ne,{children:[t.jsxs(ce,{className:"flex items-center gap-2",children:[t.jsx(de,{className:"h-5 w-5"}),"Employees (",l.length,")"]}),t.jsx(fe,{children:"Generate or download IRP5 certificates for each employee"})]}),t.jsx(n,{children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b bg-muted/50",children:[t.jsx("th",{className:"text-left p-3 w-10",children:t.jsx(ue,{checked:d.length===l.length&&l.length>0,onCheckedChange:le})}),t.jsx("th",{className:"text-left p-3",children:"Employee"}),t.jsx("th",{className:"text-left p-3",children:"Tax Number"}),t.jsx("th",{className:"text-left p-3",children:"ID Number"}),t.jsx("th",{className:"text-right p-3",children:"Total Gross"}),t.jsx("th",{className:"text-right p-3",children:"Total PAYE"}),t.jsx("th",{className:"text-center p-3",children:"Periods"}),t.jsx("th",{className:"text-center p-3",children:"Status"}),t.jsx("th",{className:"text-right p-3",children:"Actions"})]})}),t.jsx("tbody",{children:l.map(s=>t.jsxs("tr",{className:"border-b hover:bg-muted/30",children:[t.jsx("td",{className:"p-3",children:t.jsx(ue,{checked:d.includes(s.id),onCheckedChange:()=>ye(s.id)})}),t.jsx("td",{className:"p-3 font-medium",children:s.name}),t.jsx("td",{className:"p-3 font-mono text-xs",children:s.tax_number||t.jsx("span",{className:"text-muted-foreground",children:"Not set"})}),t.jsx("td",{className:"p-3 font-mono text-xs",children:s.id_number||t.jsx("span",{className:"text-muted-foreground",children:"Not set"})}),t.jsx("td",{className:"p-3 text-right font-medium",children:xe(s.total_gross)}),t.jsx("td",{className:"p-3 text-right text-blue-600 font-medium",children:xe(s.total_paye)}),t.jsx("td",{className:"p-3 text-center",children:s.periods}),t.jsx("td",{className:"p-3 text-center",children:Ce(s.irp5_status)}),t.jsx("td",{className:"p-3 text-right",children:t.jsx("div",{className:"flex justify-end gap-2",children:s.irp5_status==="pending"?t.jsxs(m,{variant:"outline",size:"sm",onClick:()=>E(s.id),disabled:P,children:[t.jsx(pe,{className:"mr-2 h-4 w-4"}),"Generate"]}):t.jsxs(t.Fragment,{children:[t.jsx(m,{variant:"outline",size:"sm",onClick:()=>E(s.id),disabled:P,children:t.jsx(be,{className:"h-4 w-4"})}),s.submission_id&&s.irp5_status!=="submitted"&&t.jsx(m,{variant:"outline",size:"sm",asChild:!0,children:t.jsx(re,{href:`/compliance/irp5/${s.submission_id}/edit`,children:t.jsx(Ie,{className:"h-4 w-4"})})}),s.submission_id&&t.jsx(m,{variant:"default",size:"sm",asChild:!0,children:t.jsxs("a",{href:`/compliance/irp5/${s.submission_id}/download`,children:[t.jsx(Ee,{className:"mr-2 h-4 w-4"}),"PDF"]})})]})})})]},s.id))})]})})})]}):t.jsx(i,{children:t.jsxs(n,{className:"flex flex-col items-center justify-center py-12",children:[t.jsx(de,{className:"h-12 w-12 text-muted-foreground mb-4"}),t.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Employees Found"}),t.jsx("p",{className:"text-muted-foreground text-center",children:"No employees with payroll data found for the selected tax year."})]})}),e[56]=l,e[57]=P,e[58]=E,e[59]=le,e[60]=d,e[61]=y):y=e[61];let Z;e[62]===Symbol.for("react.memo_cache_sentinel")?(Z=t.jsx(ne,{children:t.jsxs(ce,{className:"flex items-center gap-2 text-blue-800 dark:text-blue-200",children:[t.jsx(Fe,{className:"h-5 w-5"}),"About IRP5 Certificates"]})}),e[62]=Z):Z=e[62];let q;e[63]===Symbol.for("react.memo_cache_sentinel")?(q=t.jsxs(i,{className:"bg-blue-50 dark:bg-blue-950 border-blue-200 dark:border-blue-800",children:[Z,t.jsx(n,{className:"text-blue-800 dark:text-blue-200",children:t.jsxs("ul",{className:"space-y-2 text-sm",children:[t.jsxs("li",{children:[t.jsx("strong",{children:"Tax Year:"})," South African tax year runs from 1 March to end of February."]}),t.jsxs("li",{children:[t.jsx("strong",{children:"IRP5:"})," Employee tax certificate showing income, deductions, and tax paid during the tax year."]}),t.jsxs("li",{children:[t.jsx("strong",{children:"Deadline:"})," IRP5 certificates must be submitted to SARS via EMP501 reconciliation by 31 May each year."]}),t.jsxs("li",{children:[t.jsx("strong",{children:"Terminated Employees:"})," IRP5 certificates can be generated at any time for employees who have left the company."]})]})})]}),e[63]=q):q=e[63];let J;return e[64]!==o||e[65]!==p||e[66]!==S||e[67]!==y?(J=t.jsxs(je,{breadcrumbs:ge,children:[B,t.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 overflow-x-auto rounded-xl p-4",children:[o,p,S,y,q]})]}),e[64]=o,e[65]=p,e[66]=S,e[67]=y,e[68]=J):J=e[68],J}function Be(a){return t.jsx(Te,{value:a.value,children:a.label},a.value)}function Ye(a){switch(a){case"submitted":return t.jsx(W,{className:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:"Submitted"});case"generated":return t.jsx(W,{className:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",children:"Generated"});case"pending":return t.jsx(W,{variant:"secondary",children:"Pending"});default:return t.jsx(W,{variant:"secondary",children:a})}}function De(a){return a.id}function ze(a){return new Intl.NumberFormat("en-ZA",{style:"currency",currency:"ZAR"}).format(a)}export{_t as default};
