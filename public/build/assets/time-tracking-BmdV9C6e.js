import{c as se,r as H,j as t,a as B,H as re}from"./app-zh9bNfQA.js";import{B as Z}from"./createLucideIcon-BZjvJ1Zn.js";import{b as ne,a as ie,c as oe,C as le}from"./card-BdZbHl6r.js";import{C as ae}from"./confirmation-dialog-DD8tonQt.js";import{S as q}from"./spinner-DI7qxYjB.js";import{A as ce}from"./auth-layout-CRBTU3Ke.js";import{L as G}from"./log-in-BkLtKBQM.js";import{L as J}from"./log-out-D2fYovF8.js";import{C as me}from"./clock-CEsoW84B.js";/* empty css            */import"./dialog-BDMD06yW.js";import"./index-BH508O9j.js";import"./index-Bvd5418W.js";import"./x-BIBjS2Dr.js";import"./index-NEtNT4ix.js";import"./info-DszxC6pq.js";import"./triangle-alert-B_NYeNJG.js";import"./loader-circle-DmMzF6DP.js";import"./app-logo-icon-D-tUxb3h.js";import"./index-CcLcdVZM.js";function He(i){const e=se.c(54),{employee:n,isSignedIn:s,signInTime:r,hoursWorked:v,today:a,status:C,error:T}=i,[o,l]=H.useState(!1),[A,b]=H.useState(v),[F,Y]=H.useState(!1);let _,k;e[0]!==v||e[1]!==s||e[2]!==r||e[3]!==a?(_=()=>{if(b(s&&r?v:0),!s||!r)return;const W=()=>{try{const M=`${a}T${r}`,z=new Date(M);if(isNaN(z.getTime())){console.error("Invalid date:",M);return}const P=new Date().getTime()-z.getTime();if(P>=0){const te=P/36e5;b(Math.max(0,te))}else b(0)}catch(M){console.error("Error calculating duration:",M),b(0)}};W();const ee=setInterval(W,1e4);return()=>clearInterval(ee)},k=[s,r,a,v],e[0]=v,e[1]=s,e[2]=r,e[3]=a,e[4]=_,e[5]=k):(_=e[4],k=e[5]),H.useEffect(_,k);let I;e[6]===Symbol.for("react.memo_cache_sentinel")?(I=()=>{l(!0),B.post("/employee/time-tracking/sign-in",{},{preserveScroll:!1,onSuccess:()=>{l(!1)},onError:()=>{l(!1)},onFinish:()=>{l(!1)}})},e[6]=I):I=e[6];const K=I;let D;e[7]===Symbol.for("react.memo_cache_sentinel")?(D=()=>{Y(!0)},e[7]=D):D=e[7];const Q=D;let O;e[8]===Symbol.for("react.memo_cache_sentinel")?(O=()=>{Y(!1),l(!0),B.post("/employee/time-tracking/sign-out",{},{preserveScroll:!1,onSuccess:()=>{l(!1)},onError:()=>{l(!1)},onFinish:()=>{l(!1)}})},e[8]=O):O=e[8];const U=O,R=xe,V=fe,X=ue;let E;e[9]===Symbol.for("react.memo_cache_sentinel")?(E=t.jsx(re,{title:"Time Tracking"}),e[9]=E):E=e[9];let c;e[10]!==C?(c=C&&t.jsx("div",{className:"mb-4 text-center text-sm font-medium text-green-600",children:C}),e[10]=C,e[11]=c):c=e[11];let m;e[12]!==T?(m=T&&t.jsx("div",{className:"mb-4 text-center text-sm font-medium text-red-600",children:T}),e[12]=T,e[13]=m):m=e[13];let d;e[14]!==n.name?(d=t.jsxs(ne,{className:"text-lg",children:["Welcome, ",n.name]}),e[14]=n.name,e[15]=d):d=e[15];let u;e[16]!==n.email?(u=t.jsx("p",{className:"text-sm text-muted-foreground",children:n.email}),e[16]=n.email,e[17]=u):u=e[17];let f;e[18]!==a?(f=X(a),e[18]=a,e[19]=f):f=e[19];let x;e[20]!==f?(x=t.jsx("p",{className:"text-sm text-muted-foreground",children:f}),e[20]=f,e[21]=x):x=e[21];let p;e[22]!==u||e[23]!==x||e[24]!==d?(p=t.jsxs(ie,{children:[d,u,x]}),e[22]=u,e[23]=x,e[24]=d,e[25]=p):p=e[25];let g;e[26]!==s||e[27]!==r?(g=t.jsx("div",{className:"flex items-center justify-between rounded-lg border p-4",children:t.jsx("div",{className:"flex items-center gap-3",children:s?t.jsxs(t.Fragment,{children:[t.jsx(G,{className:"h-5 w-5 text-green-600"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-green-600",children:"Signed In"}),r&&t.jsxs("p",{className:"text-sm text-muted-foreground",children:["Since ",R(r)]})]})]}):t.jsxs(t.Fragment,{children:[t.jsx(J,{className:"h-5 w-5 text-gray-400"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-muted-foreground",children:"Signed Out"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Not currently signed in"})]})]})})}),e[26]=s,e[27]=r,e[28]=g):g=e[28];let h;e[29]!==A||e[30]!==s||e[31]!==r?(h=s&&r&&t.jsxs("div",{className:"flex items-center gap-2 rounded-lg border p-4 bg-primary/5",children:[t.jsx(me,{className:"h-5 w-5 text-primary"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Time Signed In"}),t.jsx("p",{className:"text-2xl font-bold text-primary",children:V(A)}),t.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Started at ",R(r)]})]})]}),e[29]=A,e[30]=s,e[31]=r,e[32]=h):h=e[32];let j;e[33]!==s||e[34]!==o?(j=t.jsx("div",{className:"pt-4",children:s?t.jsxs(Z,{onClick:Q,variant:"destructive",className:"w-full",size:"lg",disabled:o,children:[o&&t.jsx(q,{className:"mr-2 h-5 w-5"}),t.jsx(J,{className:"mr-2 h-5 w-5"}),"Sign Out"]}):t.jsxs(Z,{onClick:K,className:"w-full",size:"lg",disabled:o,children:[o&&t.jsx(q,{className:"mr-2 h-5 w-5"}),t.jsx(G,{className:"mr-2 h-5 w-5"}),"Sign In"]})}),e[33]=s,e[34]=o,e[35]=j):j=e[35];let y;e[36]!==g||e[37]!==h||e[38]!==j?(y=t.jsxs(oe,{className:"space-y-6",children:[g,h,j]}),e[36]=g,e[37]=h,e[38]=j,e[39]=y):y=e[39];let N;e[40]!==p||e[41]!==y?(N=t.jsxs(le,{children:[p,y]}),e[40]=p,e[41]=y,e[42]=N):N=e[42];let $;e[43]===Symbol.for("react.memo_cache_sentinel")?($=t.jsxs("div",{className:"text-center text-xs text-muted-foreground",children:[t.jsx("p",{children:"Your session will expire in 24 hours."}),t.jsx("button",{type:"button",onClick:de,className:"mt-2 text-primary hover:underline",children:"Sign out and return to login"})]}),e[43]=$):$=e[43];let S;e[44]!==N?(S=t.jsxs("div",{className:"space-y-6",children:[N,$]}),e[44]=N,e[45]=S):S=e[45];let w;e[46]!==o||e[47]!==F?(w=t.jsx(ae,{open:F,onOpenChange:Y,onConfirm:U,title:"Are you sure you want to sign out?",description:"Your current session will be recorded. Once you sign out, you will not be able to sign in again today. You can only sign in once per day.",confirmText:"Yes, Sign Out",variant:"destructive",processing:o}),e[46]=o,e[47]=F,e[48]=w):w=e[48];let L;return e[49]!==S||e[50]!==w||e[51]!==c||e[52]!==m?(L=t.jsxs(ce,{title:"Time Tracking",description:"Sign in and out for your work hours",children:[E,c,m,S,w]}),e[49]=S,e[50]=w,e[51]=c,e[52]=m,e[53]=L):L=e[53],L}function de(){B.post("/employee/sign-out-session")}function ue(i){return new Date(i).toLocaleDateString("en-ZA",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}function fe(i){if(i<0)return"0h 0m";const e=Math.floor(i*60),n=Math.floor(e/60),s=e%60;if(n===0&&s===0){const r=Math.floor(i*3600);return r>0?`${r}s`:"0s"}return`${n}h ${s}m`}function xe(i){if(!i)return"";const[e,n]=i.split(":");return`${e}:${n}`}export{He as default};
